## 缓存雪崩

**概念**

缓存雪崩指的是：缓存在同一时间大面积的失效，后面的请求都会落在数据库上，造成数据库短时间内承受大量的请求而崩掉。或者【redis重启】

**解决方案**

- 缓存过期时间设置随机，防止同一时间大量数据过期现象发生。
- 给每个缓存数据增加相应的缓存标记，记录缓存是否失效，如果缓存标记失效，则更新数据缓存，但需要一直监控，消耗较多。
- 缓存预热
- 互斥锁

## 缓存穿透

**概念**

缓存穿透指的是：缓存和数据库中都没有的数据，导致所有的请求都落到数据库上，造成数据库短时间内承受大量请求而崩掉。【一般来自攻击场景或高并发场景】

**解决方案**

- **接口层增加校验**，如用户鉴权，id做基础校验，直接拦截。
- 从缓存取不到的数据，在数据库中也没有取到，此时可以**缓存key-null**。缓存有效时间可以设置短一些，如30s【太长的话会导致正常情况也无法使用】，这样可以防止攻击用户反复用同一个id暴力攻击。
- 采用布隆过滤器，将所有可能存在的数据哈希到一个足够大的bitmap中，一个**一定不存在的数据会被拦截**，避免对底层存储系统的查询压力。

## 缓存击穿

**概念**

缓存击穿指的是：缓存中没有但数据库中有的数据【一般指缓存时间到期】，这时由于并发用户较多，同时读缓存没有读到数据，同时去数据库中取数据，引起数据库压力瞬间增大，造成过大压力。

和缓存雪崩不同的是，**缓存击穿指并发查同一条数据**，**缓存雪崩是不同的数据都过期**了， 很多数据都查不到而查数据库。

**解决方案**

- 设置热点数据永远不过期。
- 加互斥锁。

