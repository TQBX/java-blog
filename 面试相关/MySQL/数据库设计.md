设计数据库会注意什么；



3. 

## mysql执行计划怎么看？

执行计划就是sql的执行查询顺序，以及如何使用索引查询，返回的结果集的行数。

![image-20210327155730565](img/数据库设计/image-20210327155730565.png)

一、id 查询的顺序号，有几个select就显示几行，id的顺序是按select出现的顺序增长的。id列的值越大执行优先级越高越先执行，id列的值相同则从上往下执行， id列的值为null最后执行。

二、select_type 查询中每个select子句的类型

![image-20210327155925564](img/数据库设计/image-20210327155925564.png)

三、table：标识该语句查询的表

四、type：优化sql的重要字段，也是判断sql性能和优化程度重要指标，他的取值类型范围：

- const：通过索引一次命中，**匹配一行数据**。【主键||唯一】索引
- system：表中只有一行记录，相当于系统表、
- eq_ref：**唯一性索引扫描**，对于每个索引键，表中只有一条记录与之匹配。【主键||唯一】索引+ 【表联结情况】
- ref：非唯一性索引扫描，返回匹配某个值的所有。【可能重复】的【普通索引】+【表联结】
- range：只检索指定范围的行，使用一个索引来选择行，一般用于between，< , >。【索引】+【范围查询】
- index：只遍历索引树。
- all：**全表扫描**，这个类型的查询是性能最差的查询之一。

> 执行效率：all< index < range < ref < eq_ref < const < system 避免all和index

五、possible_keys：它标识mysql在执行该sql语句的时候，可能用到的索引信息，仅仅是可能，实际不一定会用到。

六、**key**：此字段是**mysql在当前查询时所使用到的索引**，是possible_keys的子集。

七、key_len：查询优化器使用的索引的字节数，可以评估联合索引是否被完全使用，也是我们优化sql时，评估索引的重要指标。

八、ref

九、rows：mysql查询优化器根据统计信息，估算该sql返回结果集需要扫描读取的行数。值越大，性能越差。

十、filter：返回结果的行占需要读到的行rows的百分比，就是百分比越高，说明需要查询到数据越准确，百分比越小，说明查询到的数据量大，而结果集很少。

十一、extra：

- using filesort：标识mysql对结果集进行**外部排序**，不能通过索引顺序达到排序效果，一般有using filesort都**建议优化**去掉，因为这样的查询cpu资源消耗大，延时大。
- using index：**覆盖索引扫描**，标识查询在索引树种就可以查找所需要的数据，不用扫描表数据文件，往往说明性能不错。
- using temporary：查询有使用**临时表**，一般出现于排序，分组和夺表join的情况，查询效率不高，**建议优化**。
- using where：sql使用了**where**过滤，效率较高。

