## ACID

```
    1. Atomicity
        事务是不可分割的最小单元，事务内所有操作要么全部执行成功，要么全部失败回滚

    2. Isolation
        事务所作出的修改，在提交前，对于其他事务而言不可见
        
    3. Durability
        事务一旦提交，所作出的修改是永久的。
        
    4. Consistency
        系统从一个正确状态-->另一个正确状态
        AID是数据库的特征，通过AID手段保证C这个目的
        
       【数据库】约束列值 不能小于0，则事务执行失败
       【应用层】约束 余额数据不能小于0，则应用层通过事务回滚保证约束
       
       没有约束，则事务执行成功，且保持了一致性。因为没有破坏约束。
```

## 并发事务带来的问题

```
    1. 脏读 
        事务A 修改数据，但并未commit。而事务B读取该数据。 
    2. 丢失修改
        事务A 、B都读取同一个数据。事务A 、B先后修改数据，则 第一次修改操作丢失。
    3. 不可重复读
        事务A 共读取两次数据，而在这两次读取之间。事务B修改了数据。则事务A两次读取到的数据不同。
    4. 幻读 
        事务A 读取【n行数据】,事务B在n行数据间添加数据。则事务A第二次读取时，读取到n+1行。
```

## 事务隔离级别

```
    1. Read-Uncommitted 读取未提交
        无论事务是否提交，直接【读取主记录】 
        即并发问题 =【脏读】+【不可重复读】+【幻影读】
    2. Read-committed 读取已提交
        【读取最新版本的快照】，快照是事务提交后产生，但可能存在同一事务两次读取的快照不同。
        即并发问题 = 【不可重复读】+【幻影读】
    3. Repeatable 可重复读
        【读取指定版本快照】，则事务多次读取某数据行的结果一致，但读取到的数据可能并非最新数据 。
        即并发问题 = 【幻影读】
    4. Serializable 可串行化 
        上表锁，读写相互阻塞。效率低下。
        无并发问题 
        
    InnoDB引擎默认实现 可重复读隔离级别 
```

## MVCC

```
【目的】 ： 
    MVCC是行锁的变种，它想要尽可能地避免加锁操作，实现【非阻塞】读。从而提高处理并发事务的性能

【MVCC 实现的隔离级别】
    MVCC仅 Read Committed & REPEATABLE READ 两种隔离级别
    READ UNCOMMITTED 总是【读取最新】数据行 ，与MVCC的版本快照机制不符
    SERIALIZABLE 则 对读取的【数据行】都加锁 ，与MVCC 尽可能避免加锁的原则不符
    
【undolog】 记录数据行的某个历史版本，undolog以链表形式存在

RC 是读取 最新版本的 undolog
RR 是读取 某一指定老版本的undolog
```