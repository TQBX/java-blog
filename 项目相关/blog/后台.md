[TOC]

# 系统结构

- 前台系统：
  - jQuery
  - SemanticUI框架
- 后台系统

  - 日志：logback
  - 数据库：MySQL
  - 持久层：JPA
  - 框架：SpringBoot2.x

# 前端插件

| 插件功能       | 插件名称及地址                                               |
| -------------- | ------------------------------------------------------------ |
| Markdown编辑器 | [https://pandao.github.io/editor.md/](https://pandao.github.io/editor.md/) |
| 排版插件       | [https://github.com/sofish/typo.css/](https://github.com/sofish/typo.css/) |
| 动画插件       | [https://github.com/animate-css/animate.css](https://github.com/animate-css/animate.css) |
| 代码高亮插件   | [https://prismjs.com/](https://prismjs.com/)                 |
| 自动生成目录   | [https://github.com/tscanlin/tocbot](https://github.com/tscanlin/tocbot) |
| 二维码生成插件 | [https://github.com/davidshimjs/qrcodejs](https://github.com/davidshimjs/qrcodejs) |
| 平滑滚动       | [https://github.com/flesler/jquery.scrollTo](https://github.com/flesler/jquery.scrollTo) |
| 滚动侦测       | [https://github.com/imakewebthings/waypoints](https://github.com/imakewebthings/waypoints) |

# 后端手册

## 多profile区分不同环境配置

Profile的意思是配置，对于应用程序来说，不同的环境需要不同的配置。
比如：

- 开发环境，应用需要连接一个可供调试的数据库单机进程
- 生产环境，应用需要使用正式发布的数据库，通常是高可用的集群
- 测试环境，应用只需要使用内存式的模拟数据库

```yml
# application.dev.yml
server:
  port: 8081
spring:
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/database?useUnicode=true&characterEncoding=utf-8&serverTimezone=UTC&useSSL=true
    username: username
    password: psword
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
logging:
  level:
    root: info
    com.hyh.blog: debug

  file:
    name: logdev
```

```yml
# application-prod.yml
server:
  port: 8082
spring:
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/database?useUnicode=true&characterEncoding=utf-8&serverTimezone=UTC&useSSL=true
    username: username
    password: psword
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
logging:
  level:
    root: warn
    com.hyh.blog: info
  file:
    name: logprod
```

在application.yml中通过spring.profiles.active指定环境：

```yml
# application.yml
spring:
  thymeleaf:
    mode: HTML
    cache: true
  profiles:
    active: prod
```

## logback相关内容

### 获取application.yml中的配置值

```yml
logging:
  level:
    root: info
    com.hyh.blog: debug

  file:
    name: logdev
```

```xml
<!-- logback-spring.xml -->
<springProperty scope="context" name="logPath" source="logging.file.name"/>
<property name="log.path" value="${logPath}" />
    <!-- 彩色日志 -->
    <!-- 配置格式变量：CONSOLE_LOG_PATTERN 彩色日志格式 -->
    <!-- magenta:洋红 -->
    <!-- boldMagenta:粗红-->
    <!-- cyan:青色 -->
    <!-- white:白色 -->
    <!-- magenta:洋红 -->
<property name="CONSOLE_LOG_PATTERN"
              value="%black(%contextName-) %red(%d{yyyy-MM-dd HH:mm:ss}) %green([%thread]) %highlight(%-5level) %boldMagenta(%logger{36}) - %gray(%msg%n)"/>
<!--输出到控制台-->
<appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
    <!--此日志appender是为开发使用，只配置最底级别，控制台输出的日志级别是大于或等于此级别的日志信息-->
    <!-- 例如：如果此处配置了INFO级别，则后面其他位置即使配置了DEBUG级别的日志，也不会被输出 -->
    <filter class="ch.qos.logback.classic.filter.ThresholdFilter">
        <level>INFO</level>
    </filter>
    <encoder>
        <Pattern>${CONSOLE_LOG_PATTERN}</Pattern>
        <!-- 设置字符集 -->
        <charset>UTF-8</charset>
    </encoder>
</appender>
```

### 彩色日志

```xml
    <!-- 彩色日志 -->
    <!-- 配置格式变量：CONSOLE_LOG_PATTERN 彩色日志格式 -->
    <!-- magenta:洋红 -->
    <!-- boldMagenta:粗红-->
    <!-- cyan:青色 -->
    <!-- white:白色 -->
    <!-- magenta:洋红 -->
<property name="CONSOLE_LOG_PATTERN"
              value="%black(%contextName-) %red(%d{yyyy-MM-dd HH:mm:ss}) %green([%thread]) %highlight(%-5level) %boldMagenta(%logger{36}) - %gray(%msg%n)"/>
```

### 输出日志到文件中

```xml
    <!--输出到文件-->

    <!-- 时间滚动输出 level为 INFO 日志 -->
    <appender name="INFO_FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <!-- 正在记录的日志文件的路径及文件名 -->
        <file>${log.path}/log_info.log</file>
        <!--日志文件输出格式-->
        <encoder>
            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n</pattern>
            <charset>UTF-8</charset>
        </encoder>
        <!-- 日志记录器的滚动策略，按日期，按大小记录 -->
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <!-- 每天日志归档路径以及格式 -->
            <fileNamePattern>${log.path}/info/log-info-%d{yyyy-MM-dd}.%i.log</fileNamePattern>
            <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
                <maxFileSize>100MB</maxFileSize>
            </timeBasedFileNamingAndTriggeringPolicy>
            <!--日志文件保留天数-->
            <maxHistory>15</maxHistory>
        </rollingPolicy>
        <!-- 此日志文件只记录info级别的 -->
        <filter class="ch.qos.logback.classic.filter.LevelFilter">
            <level>INFO</level>
            <onMatch>ACCEPT</onMatch>
            <onMismatch>DENY</onMismatch>
        </filter>
    </appender>
```

