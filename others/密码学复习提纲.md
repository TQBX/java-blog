[toc]

# 一、密码学的概念和基础知识

## 基本密码学原理及其流程图

<img src="img/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/551670129305_.pic.jpg" alt="551670129305_.pic"  />

## 两种重要的密码体制（即私钥密码体制和公钥密码体制）的主要特征

一、概念上的区别：

私钥密码体制也叫做**单钥密码体制**，使用的密钥必须完全保密，且加密密钥和解密密钥相同，或从加密密钥可推出解密密钥，反之亦可。所以又叫做**对称密码体制**。

> 按照对明文的加密方式不同，单钥密码体制分为序列密码（流密码）和分组密码（块密码）。
>
> 序列密码：将明文消息按字符逐位进行加密，也叫流密码。
>
> 分组密码：将明文消息分成等长的组，一组一组来加密，也叫块密码。

公钥密码体制也叫**双钥密码体制**，每个使用密码体制的主体均有一对密钥：一个可以公开的公钥，一个必须保密的私钥，并且不能从公钥推出私钥（或者很困难）。所以，又叫做**非对称密码体制**。

二、功能上的区别：

私钥密码体制只可用来对信息进行加密，保障信息的机密性。

而公钥密码体制可以实现两种功能：

1. 信息加密：任何人都可以用接收者的公钥对信息进行加密，接收者可以用他的私钥进行解密，达到**信息加密**的功能。
2. 数字签名：签名者用他的私钥对信息签名，任何人可用他的公钥验证这个签名，达到身份识别的功能。

## 三种类型的公钥密码体制

自1976年Diffie和Hellman提出了公钥密码体制的思想以来，人们提出了大量公钥密码体制的实现方案，他们的安全性基础主要是数学中的难题问题（陷门单向函数）。主要有三类具有影响力的公钥密码方案：

1. **基于大整数素因子分解问题**的公钥密码体制：包括**RSA体制**和Rabin体制。以RSA为例，基于以下论断：求两个大素数的乘积是计算上容易的，但要分解两个大素数的积求出它的素因子在计算上困难的。

2. **基于有限域上离散对数问题**的公钥密码体制：包括**ElGamal类公钥加密方案和数字签名方案**、Diffie-Hellman密钥交换方案等。以ElGamal为例，求解离散对数问题是困难的，而其逆运算即计算大数模幂的运算是可有效计算的。
3. **基于椭圆曲线离散对数问题**的公钥密码体制：包括**椭圆曲线型的Diffie-Hellman密钥交换方案**、椭圆曲线型的ECKEP密钥交换方案、椭圆曲线型的数字签名算法等。其理论基础是定义在有限域上的某一椭圆曲线上的有理点可构成有限交换群。如果该群的阶包含一个较大的素因子，则其上的离散对数问题是计算上难解的数学问题。

## 流密码也称为序列密码，它的基本思想是什么

<img src="img/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/561670133578_.pic.jpg" alt="561670133578_.pic"  />

## 分组密码方案

### 请分别说明DES、AES和SM4的基本结构和特点

>  比如块大小、密钥长度、循环数，以及圆变换的四种变换是什么?

DES：

- 明文长度64bit，有效密钥长度为56bit（还有8bit的奇偶校验），加密后的密文长度也是64bit。实际中的明文未必恰好是64bit，因此要经过分组和填充把它们对齐为若干个64bit的组，然后进行加密处理。

- 基本流程：

  - 初始置换IP，用于重排明文分组的64bit。
  - 16轮圈函数变化，16轮的变换的输出不交换次序。
  - 逆初始置换，从而产生64bit的密文。

  ![image-20221204144842025](img/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/image-20221204144842025.png)

AES：

- 明文分组长度固定为128bit，密钥长度有三种选择：128bit、192bit、256bit。和DES都是迭代型密码，迭代次数$N_r$依赖于密钥长度。

- 基本流程：

  ![591670136758_.pic](img/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/591670136758_.pic.jpg)

SM4：

- 是对称分组算法，分组长度和密钥长度均为128bit。

- 使用32轮的非线性迭代结构，在最后一轮非线性迭代之后加了一个反序变换，因此SM4中只要解密密钥是加密密钥的逆序，它的解密算法与加密算法就可以保持一致。

- 算法结构：

  ![601670136991_.pic](img/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/601670136991_.pic.jpg)

b)   它们的优点和缺点是什么？这些分组密码的安全性有多强？

DES：密钥长度太短，56bit的密钥对穷搜索攻击来说，太短了。优点是：受到攻击，从未发现任何结构方面的问题。

AES：是DES的替代算法，计算速度比三重DES快，切安全性也不比三重DES弱。还支持128bit、192bit和256bit的密钥长度。具体来说，AES算法设计能够抵抗多种攻击：

- 有限域的有关性质给加密解密提供了良好的理论基础，使其既能够高度隐藏信息，又保证了算法的可逆性。
- 加解密使用不同的变换，消除了在DES中出现的弱密钥和半密钥的可能性。
- 字节代换的构造中有限域逆操作的应用为抵御差分和线性攻击提供了安全性。
- 密钥扩展中每轮常数的不同消除了圈密钥的对称性。

SM4：该算法中的S-盒的设计，采用的是能够很好抵抗插值攻击的仿射函数逆映射复合法，很好地抵抗了插值攻击。

## 请解释SM9密钥和公钥是如何生成的

## 请解释SM9在基于 ID 的公钥加密算法和一般公钥加密算法之间的区别

## 公钥加密算法由哪些步骤组成

