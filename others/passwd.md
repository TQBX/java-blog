[toc]

# 一、密码学的概念和基础知识

## 基本密码学原理及其流程图

<img src="img/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/551670129305.jpg" alt=""  />

## 两种重要的密码体制（即私钥密码体制和公钥密码体制）的主要特征

一、概念上的区别：

私钥密码体制也叫做**单钥密码体制**，使用的密钥必须完全保密，且加密密钥和解密密钥相同，或从加密密钥可推出解密密钥，反之亦可。所以又叫做**对称密码体制**。

> 按照对明文的加密方式不同，单钥密码体制分为序列密码（流密码）和分组密码（块密码）。
>
> 序列密码：将明文消息按字符逐位进行加密，也叫流密码。
>
> 分组密码：将明文消息分成等长的组，一组一组来加密，也叫块密码。

公钥密码体制也叫**双钥密码体制**，每个使用密码体制的主体均有一对密钥：一个可以公开的公钥，一个必须保密的私钥，并且不能从公钥推出私钥（或者很困难）。所以，又叫做**非对称密码体制**。

二、功能上的区别：

私钥密码体制只可用来对信息进行加密，保障信息的机密性。

而公钥密码体制可以实现两种功能：

1. 信息加密：任何人都可以用接收者的公钥对信息进行加密，接收者可以用他的私钥进行解密，达到**信息加密**的功能。
2. 数字签名：签名者用他的私钥对信息签名，任何人可用他的公钥验证这个签名，达到身份识别的功能。

## 三种类型的公钥密码体制

自1976年Diffie和Hellman提出了公钥密码体制的思想以来，人们提出了大量公钥密码体制的实现方案，他们的安全性基础主要是数学中的难题问题（陷门单向函数）。主要有三类具有影响力的公钥密码方案：

1. **基于大整数素因子分解问题**的公钥密码体制：包括**RSA体制**和Rabin体制。以RSA为例，基于以下论断：求两个大素数的乘积是计算上容易的，但要分解两个大素数的积求出它的素因子在计算上困难的。

2. **基于有限域上离散对数问题**的公钥密码体制：包括**ElGamal类公钥加密方案和数字签名方案**、Diffie-Hellman密钥交换方案等。以ElGamal为例，求解离散对数问题是困难的，而其逆运算即计算大数模幂的运算是可有效计算的。
3. **基于椭圆曲线离散对数问题**的公钥密码体制：包括**椭圆曲线型的Diffie-Hellman密钥交换方案**、椭圆曲线型的ECKEP密钥交换方案、椭圆曲线型的数字签名算法等。其理论基础是定义在有限域上的某一椭圆曲线上的有理点可构成有限交换群。如果该群的阶包含一个较大的素因子，则其上的离散对数问题是计算上难解的数学问题。

## 流密码也称为序列密码，它的基本思想是什么

<img src="img/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/561670133578.jpg" alt=""  />

## 分组密码方案

### 请分别说明DES、AES和SM4的基本结构和特点

>  比如块大小、密钥长度、循环数，以及圆变换的四种变换是什么?

DES：

- 明文长度64bit，有效密钥长度为56bit（还有8bit的奇偶校验），加密后的密文长度也是64bit。实际中的明文未必恰好是64bit，因此要经过分组和填充把它们对齐为若干个64bit的组，然后进行加密处理。

- 基本流程：

  - 初始置换IP，用于重排明文分组的64bit。
  - 16轮圈函数变化，16轮的变换的输出不交换次序。
  - 逆初始置换，从而产生64bit的密文。

  ![image-20221204144842025](img/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/image-20221204144842025.png)

AES：

- 明文分组长度固定为128bit，密钥长度有三种选择：128bit、192bit、256bit。和DES都是迭代型密码，迭代次数$N_r$依赖于密钥长度。

- 基本流程：

  ![591670136758_.pic](img/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/591670136758.jpg)

SM4：

- 是对称分组算法，分组长度和密钥长度均为128bit。

- 使用32轮的非线性迭代结构，在最后一轮非线性迭代之后加了一个反序变换，因此SM4中只要解密密钥是加密密钥的逆序，它的解密算法与加密算法就可以保持一致。

- 算法结构：

  ![601670136991_.pic](img/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/601670136991.jpg)

###  它们的优点和缺点是什么？这些分组密码的安全性有多强？

DES：密钥长度太短，56bit的密钥对穷搜索攻击来说，太短了。优点是：受到攻击，从未发现任何结构方面的问题。

AES：是DES的替代算法，计算速度比三重DES快，切安全性也不比三重DES弱。还支持128bit、192bit和256bit的密钥长度。具体来说，AES算法设计能够抵抗多种攻击：

- 有限域的有关性质给加密解密提供了良好的理论基础，使其既能够高度隐藏信息，又保证了算法的可逆性。
- 加解密使用不同的变换，消除了在DES中出现的弱密钥和半密钥的可能性。
- 字节代换的构造中有限域逆操作的应用为抵御差分和线性攻击提供了安全性。
- 密钥扩展中每轮常数的不同消除了圈密钥的对称性。

SM4：该算法中的S-盒的设计，采用的是能够很好抵抗插值攻击的仿射函数逆映射复合法，很好地抵抗了插值攻击。

## 请解释SM9密钥和公钥是如何生成的

## 请解释SM9在基于 ID 的公钥加密算法和一般公钥加密算法之间的区别



# 二、公钥密码系统：加密和签名

## 公钥加密算法由哪些步骤组成？ 

pass

## 请分别描述RSA、ElGamal和ECC的加密算法和签名算法的整个步骤 

### RSA

![641670304883_.pic_hd](img/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/641670304883.jpg)

### ElGamal

![651670304970_.pic_hd](img/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/651670304970.jpg)

### ECC

![661670305094_.pic](img/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/661670305094.jpg)

## 请说明数字签字的基本特征/功能

数字签名是手写签名的数字化形式，与所签信息绑定在一起。是一串二进制数，有以下基本特性：

1. 签名可信性：其他人可利用相关的公开消息验证签名的有效性。
2. 不可抵赖性：签名者事后不能否认自己的签名。
3. 不可复制性：即不可对某一数字内容或消息的签名进行复制。
4. 不可伪造性：任何其他人不能伪造签名者的签名。
5. 数据完整性：已签名的内容或消息是不可改变的。

## 数字签名的方案具体实现

数字签名方案的具体实现分为三步：

1. 参数建立
2. 签名生成
3. 签名验证

## 使用RSA，ElGamal或ECC进行加密或签名的一些计算

```
a)	示例 1：假设在 RSA 方案中，设 p = 5，q = 11，其公钥 e = 7。
i.	计算与公钥 e 对应的私钥 d。
ii.	假设明文m = 10，请找到其对应的密文c。稍后，尝试从 c 恢复明文。
iii.	此外，您可以尝试在消息m = 10上生成签名，然后验证您的签名。

b)	例2：假设E是椭圆曲线y^2 = x^3-x-2（ 在有限域F11上） 
i.	证明点 P = （1， 3） 和 Q = （2，2） 是 E 上的点; 
ii.	计算 P + Q 和 15P; 
iii.	对于给定的消息 m，请尝试对其进行加密，然后解密加密的消息（即恢复原始消息 m），或者尝试生成签名，然后对其进行验证。

```

# 三、哈希函数

## Hash的概念，其基本属性和功能

Hash函数的概念：

- 将任意长度的消息映射成某一固定长度的消息的一种函数。一般吧Hash值称为输入消息的消息摘要MD或数字指纹。

Hash函数的性质：

1. 单向性：如果对任意给定的y，寻找使`h(x)=y`成立的x在计算上是困难的。
2. 弱抗碰撞：已知x，寻找`x' != x`， 使得`h(x) = h(x')`在计算上是困难的。
3. 强抗碰撞：寻找两个不同的x与x‘，使得`h(x) = h(x')`在计算上是困难的。

## MD5和SHA-1的基本属性，包括单向属性、消息摘要长度及其基本算法步骤等

### MD5

- 迭代结构的Hash函数。
- 输入为任意长度，分组长度512bit，输出128bit消息摘要。
- 算法步骤
  - 预处理：对消息填充，最后填充0或1，将最后的消息块分为比特分别为512和448的两个块。$m = m_1m_2...m_{t-1}m'_t$
    - 将原始消息$m$的长度 $l$ 表示成64bit的二进制形式（若不足64bit，则从最低位添加0，若超过64bit，则取最低位的64bit）。
    - 将 $l$ 的64bit的二进制形式添加到$m'_t$的右端后记为$m_t$。
    - 将每个消息块$m_i(i=1,2,...,t-1)$分拆成16个字。
    - 记$M=M[0]M[1]...M[N-1]$为消息$m$经上述数据处理后得到的字表示。
  - MD5算法的逻辑程序
    - 初始化MD5的缓冲区
    - 对i=1，2，...，64
    - pass

### SHA-1

- 对于输入的任意长度的消息m，采用与MD5相同的方法将m进行数据分析与填充后得到字表示：M=M[0]M[1]...M[N-1]。
- 每个M[i]均为一个32bit的字，N是16的倍数。
- 算法步骤
  - 每一分组都经过压缩函数处理，压缩函数有4轮处理过程。
  - 每轮又对缓冲区的值进行20步迭代运算。

# 四、密钥管理和密钥交换协议

## Diffie-Hellman协议：定义和计算

# 五、密码学的实际应用

请举例说明一些密码算法或密码系统在一些实际场景中的应用，如数字货币（如比特币）、区块链、大数据服务、电子政务、电子商务、网络金融（如DeFi）、物联网、社交平台或其他环境，并对应用情况进行一些描述或分析。

