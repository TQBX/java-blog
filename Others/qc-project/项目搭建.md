# 模块化开发

## 公共模块搭建

- 创建父模块，利用`<dependencyManagement>`进行依赖管理，只是控制依赖的版本，并没有真正引入依赖。直接用`<dependencies>`包裹的依赖是公用的。
- 创建公共模块（第二级），`qc-common`，引入Spring等相关公共依赖。
- 创建公共模块的子模块（第三级），
  - `qc-common-service`：公共服务模块，引入mybatis，mysql等模块。
  - `qc-common-web`：公共web模块，引入安全模块，文件上传模块等。
  - `qc-pojo`：实体模块，引入jpa依赖。
  - `qc-interface`：接口模块，引入`qc-pojo`

## 服务模块搭建

- 创建`qc-service-goods`模块，将打包方式改为`<packaging>war</packaging>`。
- 引入两个公共模块，`qc-interface`和`qc-common-service`。需要注意的是，由于具有传递性，俩模块中的配置都可以被服务模块读取到。
- 引入tomcat插件，注意之后的每个需要tomcat插件的端口号需要不同。
- 在main目录下创建webapp，在之中创建WEB-INF/web.xml，用于加载spring配置文件。

## web模块搭建

- 创建`qc-web-manager`模块，将打包方式改为`<packaging>war</packaging>`。
- 引入两个公共模块，`qc-interface`和`qc-common-web`。需要注意的是，由于具有传递性，俩模块中的配置都可以被服务模块读取到。
- 引入tomcat插件，注意之后的每个需要tomcat插件的端口号需要不同。
- 在main目录下创建webapp，在之中创建WEB-INF/web.xml，用于加载spring配置文件。

# 编写简单demo测试

## 编写实体类

在`qc-pojo`中编写实体类

```java
@Table(name = "tb_brand")
public class Brand implements Serializable {
    @Id
    private Integer id;
    private String name;
    private String image;
    private String letter;
    private Integer seq;
    //省略getter和setter
}
```

# 编写mapper继承通用Mapper

在`qc-service-goods`中编写mapper。

```java
/**
 * 继承通用Mapper,具有增删改查的基本方法
 * @author Summerday
 */
public interface BrandMapper extends Mapper<Brand> {
}
```

# 编写Service接口和实现类

在`qc-interface`中编写Service接口，在`qc-service-goods`中编写实现类。

```java
public interface BrandService {
    public List<Brand> findAll();
}

@Service //com.alibaba.dubbo.config.annotation.Service
public class BrandServiceImpl implements BrandService {

    @Autowired
    private BrandMapper brandMapper;

    @Override
    public List<Brand> findAll() {
        return brandMapper.selectAll();
    }
}
```

# 编写控制器

在`qc-web-manager`中编写控制器

```java
@RestController
@RequestMapping("/brand")
public class BrandController {

    @Reference //调用远程接口用@Reference
    private BrandService brandService;

    @RequestMapping("/findAll")
    public List<Brand> findAll(){
        return brandService.findAll();
    }
}
```

# 安装Zookeeper

- 下载地址：[http://mirrors.hust.edu.cn/apache/zookeeper/](http://mirrors.hust.edu.cn/apache/zookeeper/)

- 将conf目录下的zoo_sample.cfg改名为zoo.cfg。

- 修改zoo.cfg文件的配置，设置数据和日志存放的路径。

  ```xml
  dataDir=E:\\Java\\zookeeper-3.4.13\\datas
  dataLogDir=E:\\Java\\zookeeper-3.4.13\\logs
  ```

- 配置JAVA_HOME
- 双击zkServer.cmd启动。

# Maven打包install：The packaging for this project did not assign a file to the build artifact

参考：[https://blog.csdn.net/Camellia919/article/details/81190450](https://blog.csdn.net/Camellia919/article/details/81190450)

选择LifeCycle中的install即可，因为该操作将会自动去maven仓库下载需要的包。

# No mapping found for HTTP request with URI [/brand/findAll.do] in DispatcherServlet with name 'springmvc'

1. 查看请求的url是否与设置的requestMapping("/findAll")相同。
2. 查看是否正确扫描controller包。`<context:component-scan base-package="com.qingcheng.controller"/>`。

