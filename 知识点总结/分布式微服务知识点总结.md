[toc]



# SOA、分布式、微服务之间有什么关系和区别？

1. SOA：面向服务
2. 分布式：
3. 微服务

# SpringCloud

## SpringCloud有哪些常用组件

> 5大组件：注册中心、负载均衡、远程调用、服务熔断、网关

**注册中心**（Eureka、Nacos、**Consul**）

配置中心（Nacos、**Consul**、Spring Cloud Config）

**RPC调用**（**Feign**、OpenFeign、Dubbo）

**服务网关**（**Spring Cloud Gateway**、Zuul、Kong）

链路追踪（Spring Cloud Sleuth、Zipkin）

**负载均衡**（**Ribbon**）

分布式事务（Seata）

**服务熔断**（Sentinel 、**Hystrix**）

## 服务注册和发现？怎么实现的？

常见的注册中心：**eureka、nacos**、zookeeper

### **注册中心有哪些作用啊？**

- 服务注册：服务提供者把自己的信息注册到eureka，由eureka来保存这些信息（服务名称、ip、端口）

- 服务发现：消费者向eureka拉取服务列表信息，如果服务提供者有集群，则消费者会利用负载均衡算法，选择一个发起调用

- 服务监控：服务提供者会每隔30s向eureka发送心跳，报告健康状态，如果eureka服务90s没接收到心跳，就从eureka中剔除

### **nacos和eureka的区别？？**

![image-20240728010417532](img/%E5%88%86%E5%B8%83%E5%BC%8F%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/image-20240728010417532.png)

注册中心：

1. 注册服务中心
2. 拉取服务
3. 负载均衡
4. 远程调用

## 负载均衡

### ribbon的负载均衡策略有哪些？

### 怎么自定义负载均衡策略？

## 熔断降级



## 监控



# 业务相关

## 限流

### 漏桶

### 令牌桶

## 分布式事务

### 分布式理论CAP、BASE

直接看看百度百科给出的解释吧：

> CAP原则又称CAP定理，指的是在一个分布式系统中，[一致性](https://baike.baidu.com/item/一致性/9840083)（Consistency）、[可用性](https://baike.baidu.com/item/可用性/109628)（Availability）、[分区容错性](https://baike.baidu.com/item/分区容错性/23734073)（Partition tolerance）。CAP 原则指的是，这三个要素最多只能同时实现两点，不可能三者兼顾。

- 一致性（C）：在**分布式系统**中的所有数据备份，**在同一时刻是否同样的值**。（等同于所有节点访问同一份最新的数据副本）

- 可用性（A）：在集群中一部分节点**故障**后，集群整体**是否还能响应**客户端的读写请求。（对数据更新具备高可用性）

- 分区容忍性（P）：以实际效果而言，分区相当于对通信的时限要求。系统如果不能在时限内达成数据一致性，就意味着发生了分区的情况，必须就当前操作在C和A之间做出选择。

> **分布式系统理论上不可能选择 CA 架构，只能选择 CP 或者 AP 架构。** 比如 ZooKeeper、HBase 就是 CP 架构，Cassandra、Eureka 就是 AP 架构，Nacos 不仅支持 CP 架构也支持 AP 架构。 ——JavaGuide 

### 分布式事务解决方案

### seata

## 分布式服务接口幂等



## 分布式任务调度

### xxl-job



# 消息中间件

## RabbitMQ

## kafka

# 如何实现接口的幂等性

**什么是幂等？**

相同条件下对一个业务的操作，不管操作多少次，结果都是一样的。

1. **唯一id**，每次操作，都根据操作和内容生成唯一的id，在执行之前先判断id是否存在，如果不存在则执行后续操作，并保存到数据库或者redis。
2. 服务端提供发送**token**的接口，业务调用接口先获取token，调用业务接口请求时，把token携带过去，服务器判断token是否存在redis种，存在表示第一次请求，可以继续执行任务，执行业务完成后，最后需要把redis种的token删除。
3. 建**去重表**，将业务中有标识的字段保存到去重表，如果表中存在，则表示已经处理过了。
4. **版本控制**。增加版本号，当版本号符合时，才能更新数据。【乐观锁的概念】
5. **状态控制**。例如订单有状态已支付，未支付，支付中，支付失败，当处于未支付的时候才允许修改为支付中等。

# 分布式事务解决方案

