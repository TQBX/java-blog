# è®¾è®¡æ¨¡å¼

## å•ä¾‹æ¨¡å¼

### åŒé‡æ£€æŸ¥é”

ç”¨åŒé‡æ£€æŸ¥é”çš„æ–¹å¼å®ç°å•ä¾‹æ¨¡å¼ï¼š

```java
public class Singleton {
	//æ³¨æ„ä½¿ç”¨volatileé˜²æ­¢æŒ‡ä»¤é‡æ’åº
    private volatile static Singleton instance;
	//ç§æœ‰åŒ–æ„é€ æ–¹æ³•ï¼Œå•ä¾‹æ¨¡å¼åŸºæœ¬æ“ä½œ
    private Singleton() {
    }
	//é™æ€è·å–å•ä¾‹çš„æ–¹æ³•
    public  static Singleton getInstance() {
       //å…ˆåˆ¤æ–­å¯¹è±¡æ˜¯å¦å·²ç»å®ä¾‹è¿‡ï¼Œæ²¡æœ‰å®ä¾‹åŒ–è¿‡æ‰è¿›å…¥åŠ é”ä»£ç 
        if (instance == null) {
            //ç±»å¯¹è±¡åŠ é”
            synchronized (Singleton.class) {
                if (instance == null) {
                    instance = new Singleton();
                }
            }
        }
        return instance;
    }
}
```

ä½¿ç”¨`volatile`çš„åŸå› ï¼šé˜²æ­¢æŒ‡ä»¤é‡æ’åºã€‚

> `instance= new Singleton();`è¿™ä¸€æ­¥ï¼Œæ˜¯ä¸€ä¸ªå®ä¾‹åŒ–çš„è¿‡ç¨‹ï¼Œåº•å±‚å…¶å®åˆ†ä¸ºä¸‰éƒ¨æ‰§è¡Œï¼š
>
> 1. ä¸ºinstanceåˆ†é…å†…å­˜ç©ºé—´ï¼š`memory = allocate();`
> 2. å®ä¾‹åŒ–instanceã€‚`ctorInstance(memory);`
> 3. å°†instanceæŒ‡å‘åˆ†é…çš„å†…å­˜åœ°å€ã€‚`instance = memory;`

ç”±äºJVMå…·æœ‰æŒ‡ä»¤é‡æ’åºçš„ç‰¹æ€§ï¼ŒæŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºå¯èƒ½ä¼šå˜æˆ1ï¼Œ3ï¼Œ2ã€‚åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¯èƒ½æŸä¸ªçº¿ç¨‹å¯èƒ½ä¼šå¾—åˆ°æœªåˆå§‹åŒ–çš„å®ä¾‹ã€‚

ä¸¾ä¸ªä¾‹å­ï¼šåŠ å…¥çº¿ç¨‹Aæ‰§è¡Œäº†1å’Œ2ä¹‹åï¼Œçº¿ç¨‹Bè°ƒç”¨getInstanceçš„æ—¶å€™ï¼Œä¼šå‘ç°instanceä¸ä¸ºnullï¼Œä¼šç›´æ¥è¿”å›è¿™ä¸ªæ²¡æœ‰æ‰§è¡Œè¿‡æŒ‡ä»¤3çš„å®ä¾‹ã€‚



### é™æ€å†…éƒ¨ç±»

```java
public class Singleton {
    private Singleton() {
    }

    public static Singleton getInstance() {
        return SingletonHolder.instance;
    }

    /**
     * é™æ€å†…éƒ¨ç±»
     */
    private static class SingletonHolder {
        private static Singleton instance = new Singleton();
    }
}
```

ç¬¬ä¸€æ¬¡åŠ è½½Singletonç±»æ—¶ä¸ä¼šåˆå§‹åŒ–å®ä¾‹ï¼Œåªæœ‰åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨getInstanceæ–¹æ³•æ—¶ï¼Œè™šæ‹Ÿæœºæ‰ä¼šåŠ è½½holderã€‚

æ—¢ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œä¹Ÿä¿è¯å•ä¾‹å¯¹è±¡å”¯ä¸€ï¼Œä¹Ÿå®ç°å»¶è¿Ÿåˆå§‹åŒ–ã€‚

### æšä¸¾å•ä¾‹

double checkå’Œé™æ€å†…éƒ¨ç±»çš„å†™æ³•éƒ½ä¸é”™ï¼Œä½†æ˜¯éƒ½ä¸èƒ½é˜²æ­¢è¢«ååºåŠ£åŒ–ç”Ÿæˆå¤šä¸ªå®ä¾‹ã€‚

ä½†æšä¸¾å•ä¾‹å¯ä»¥ï¼

```java
public enum SingletonEnum {
    INSTANCE;
}
```

é»˜è®¤æšä¸¾å®ä¾‹çš„åˆ›å»ºæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå³ä½¿**ååºåˆ—åŒ–**ä¹Ÿä¸ä¼šç”Ÿæˆæ–°çš„å®ä¾‹ï¼Œ**ä»»ä½•æƒ…å†µä¸‹éƒ½æ˜¯ä¸€ä¸ªå•ä¾‹**ã€‚

# ç®—æ³•

## å¿«æ’ã€å½’å¹¶

å½’å¹¶

```java
    private void merge(int[] q, int l, int r) {
        if(l >= r) return;
        int mid = l + r >> 1;
        merge(q, l, mid);
        merge(q, mid + 1, r);
        int[] tmp = new int[r - l + 1];

        int k = 0, i = l, j = mid + 1;
        while(i <= mid && j <= r)
            if(q[i] <= q[j]) tmp[k++] = q[i++];
            else tmp[k++] = q[j++];

        while(i <= mid) tmp[k++] = q[i++];
        while(j <= r) tmp[k++] = q[j++];

        for(i = l, j = 0; i <= r; i++, j++) q[i] = tmp[j];
    }
```

å¿«æ’

```java
    void quickSort(int[] q, int l, int r) {
        if(l >= r) return;
        int i = l - 1, j = r + 1, x = q[l + r >> 1];
        while(i < j) {
            do i++; while(q[i] < x);
            do j--; while(q[j] > x);
            if(i < j) swap(q, i, j);
        }
        quickSort(q, l, j);
        quickSort(q, j + 1, r);

    }
```



```java
    int p(int[] x, int l, int r) {
        int i = l, j = r, t = x[l];
        while(i < j) {
            while(i < j && x[j] >= t) {
                j --;
            }
            if(i < j) {
                x[i] = x[j];
                i ++;
            }
            while(i < j && x[i] < t) {
                i ++;
            }
            if(i < j) {
                x[j] = x[i];
                j --;
            }
        }
        x[i] = t;
        return i;
    }
    void qs(int[] x, int l, int r) {
        if(l >= r) return;
        int pivot = p(x, l, r);
        qs(x, l, pivot - 1);
        qs(x, pivot + 1, r);
    }
```

LC3æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²

LC93 å¤åŸIPåœ°å€

LC415 å­—ç¬¦ä¸²ç›¸åŠ ï¼ˆå¤§æ•°ç›¸åŠ ï¼Œè®°å¾—è¿›ä½1ï¼‰

LCR181 å­—ç¬¦ä¸²ä¸­çš„å•è¯åè½¬

LC15 ä¸‰æ•°ä¹‹å’Œ

LC39ç»„åˆç»¼åˆ

LC40ç»„åˆæ€»å’Œ2

LC215 æ•°ç»„ä¸­çš„ç¬¬kä¸ªæœ€å¤§å…ƒç´ 

LC704 äºŒåˆ†æŸ¥æ‰¾

LC121 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº

LC53 æœ€å¤§å­æ•°ç»„å’Œ

LC20 æœ‰æ•ˆçš„æ‹¬å·

LCR090æ‰“å®¶åŠ«èˆ2

LC165æ¯”è¾ƒç‰ˆæœ¬å·

LC189 è½®è½¬æ•°ç»„

LC124 äºŒå‰æ ‘ä¸­çš„æœ€å¤§è·¯å¾„å’Œ

```java
```



LC82 åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ 2

LC5æœ€é•¿å›æ–‡å­ä¸²

LC146 LRUæœºåˆ¶

LC1120 å­æ•°çš„æœ€å¤§å¹³å‡å€¼

LC509 æ–æ³¢é‚£å¥‘æ•°



## éé€’å½’ä¸­åºéå†

æ€è·¯ï¼šå·¦å­æ ‘ä¸€ç›´å¾€å·¦èµ°ï¼Œå…¥æ ˆï¼Œç›´åˆ°èµ°åˆ°nullã€‚ é€€å›ä¸€æ­¥ï¼Œå…¥ç­”æ¡ˆï¼Œå¾€å³å­æ ‘èµ°ä¸€æ­¥

```java
    public List<Integer> inorderTraversal(TreeNode root) {
        List<Integer> res = new ArrayList<>();
        Stack<TreeNode> stk = new Stack<>();
        while(root != null || !stk.isEmpty()) {
            if(root != null) {
                stk.push(root);
                root = root.left;
            } else {
                root = stk.pop();
                res.add(root.val);
                root = root.right;
            }
        }
        return res;
    }
```

## pythonå†™æ³•

```python
class Solution:
    def sortedArrayToBST(self, nums: List[int]) -> Optional[TreeNode]:
        # é€‰æ‹©[l, r] çš„æ ‘ï¼Œè¿”å›æ ‘æ ¹
        def dfs(nums, l, r):
            if l > r:
                return None
            mid = l + r >> 1
            rv = TreeNode(nums[mid])
            rv.left = dfs(nums, l, mid - 1)
            rv.right = dfs(nums, mid + 1, r)
            return rv
        return dfs(nums, 0, len(nums) - 1)
```

## äºŒå‰æ ‘ç±»å‹çš„

æ˜ç¡®dfsçš„å‚æ•°ã€å­é—®é¢˜ã€è¿”å›å€¼ã€ç»ˆæ­¢æ¡ä»¶

æ¯”å¦‚ ååºçš„è¿™äº›ï¼š

- ç¿»è½¬äºŒå‰æ ‘ï¼Œå®šä¹‰TreeNode dfs(root) ç¿»è½¬ä»¥rootä¸ºæ ¹çš„æ ‘ï¼Œè¿”å›ç¿»è½¬ä¹‹åçš„ç»“æœã€‚root.L = dfs(root.R) root.R = dfs(root.L)
- äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ï¼šå®šä¹‰int dfs(root) è¿”å›ä»¥rootä¸ºæ ¹çš„æœ€å¤§æ·±åº¦ ï¼Œè¿”å›max(dfs(root.L) ï¼Œ dfs(root.R)) + 1
- å¯¹ç§°äºŒå‰æ ‘ï¼Œå®šä¹‰boolean dfs(p, q) åˆ¤æ–­ä¸¤ä¸ªæ ‘ æ˜¯å¦å¯¹ç§°  è¿”å› p.val == q.val && dfs(p.left, q.right) && dfs(p.right, q.left) 
- æ ‘çš„ç›´å¾„ï¼Œdfså®šä¹‰ä¸º ä»¥rootä¸ºæ ¹ åˆ°å¶å­ç»“ç‚¹çš„æœ€é•¿è·ç¦» ï¼Œè¿”å›max(dfs(L) ,dfs(R)) + 1
- æœ‰åºæ•°ç»„æ„é€ äºŒå‰æœç´¢æ ‘ï¼Œ dfs(nums, l, r) å®šä¹‰numsä¸­é€‰[l, r]ä¸­å»ºæ ‘å¹¶è¿”å›æ ‘æ ¹
- [ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘](https://leetcode.cn/problems/construct-binary-tree-from-preorder-and-inorder-traversal/) dfs(pl, pr, il, ir) é€‰æ‹©preorder[pl, pr] å’Œ inorder[il, ir]éƒ¨åˆ†å»ºç«‹æ ‘

æ¯”å¦‚ ä¸­åºçš„è¿™äº›ï¼š

- [éªŒè¯äºŒå‰æœç´¢æ ‘](https://leetcode.cn/problems/validate-binary-search-tree/)ï¼šdfså®šä¹‰ä¸ºå½“å‰rootæ˜¯å¦ä¸ºäºŒå‰æœç´¢æ ‘ï¼Œå…ˆåˆ¤æ–­dfs(root.left) å†åˆ¤æ–­å½“å‰å€¼å’Œpreçš„å…³ç³»ï¼Œå†åˆ¤æ–­dfs(root.right)
- [äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ ](https://leetcode.cn/problems/kth-smallest-element-in-a-bst/) å…ˆdfså·¦è¾¹çš„ï¼Œk--ï¼Œkåˆ°0è¡¨ç¤ºæ‰¾åˆ°ç­”æ¡ˆï¼Œå¹¶ä¸”å¯ä»¥è¿”å›äº†

æ¯”å¦‚ï¼šå…ˆå³å­æ ‘å†å·¦å­æ ‘

- [äºŒå‰æ ‘çš„å³è§†å›¾](https://leetcode.cn/problems/binary-tree-right-side-view/)ï¼šå³è§†å›¾ åˆ¤æ–­ç¬¬ä¸€æ¬¡åˆ°è¾¾æŸä¸ªæ·±åº¦ æ‰æ·»åŠ åˆ°ç­”æ¡ˆé‡Œ å…ˆé€’å½’å³å­æ ‘ã€å†é€’å½’å·¦å­æ ‘

å±‚åºéå†ï¼š

- [äºŒå‰æ ‘çš„å±‚åºéå†](https://leetcode.cn/problems/binary-tree-level-order-traversal/)ï¼šé˜Ÿåˆ—fifo

éé€’å½’çš„ï¼š

- [äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨](https://leetcode.cn/problems/flatten-binary-tree-to-linked-list/) åˆ¤æ–­æœ‰æ— å·¦å­æ ‘ï¼Œæœ‰å·¦å­æ ‘å°±å…ˆæŠŠå·¦å­æ ‘å³é“¾æ’å…¥

# SQLè¿›é˜¶

## SQLçš„æ‰§è¡Œé¡ºåº

```sql
select distinct
       a.sex,
       b.city,
       count(1) as cnt,
       sum(salary) as sum1
from table1 a
join table2 b on a.id=b.id
where a.name=b.name
group by a.sex,b.city
having cnt>=2
order by a.sex,b.city
limit 10
```

æ‰§è¡Œé¡ºåºï¼š

1. from å»åŠ è½½table1å’Œtable2 ä¸¤ä¸ªè¡¨
2. join å’Œ onæŠŠä¸¤ä¸ªè¡¨é“¾æ¥èµ·æ¥
3. whereè¿‡æ»¤æ¡ä»¶
4. group byè¿›è¡Œåˆ†ç»„
5. è®¡ç®—èšåˆ count å’Œ sum
6. havingè¿›è¡Œè¿›ä¸€æ­¥è¿‡æ»¤åˆ†ç»„
7. distinct å»é‡
8. order byæ’åº
9. limitå–è®°å½•

## è¡Œè½¬åˆ— group by + sum(if())

### åŸºç¡€è¡Œè½¬åˆ—

å·²çŸ¥

| year | month | amount |
| ---- | ----- | ------ |
| 1991 | 1     | 1.1    |
| 1991 | 2     | 1.2    |
| 1991 | 3     | 1.3    |
| 1991 | 4     | 1.4    |
| 1992 | 1     | 2.1    |
| 1992 | 2     | 2.2    |
| 1992 | 3     | 2.3    |
| 1992 | 4     | 2.4    |

æŸ¥æˆè¿™æ ·ä¸€ä¸ªç»“æœ

| year | m1   | m2   | m3   | m4   |
| ---- | ---- | ---- | ---- | ---- |
| 1991 | 1.1  | 1.2  | 1.3  | 1.4  |
| 1992 | 2.1  | 2.2  | 2.3  | 2.4  |

```sql
create table table2(year int,month int ,amount double) ;

insert into table2
values (1991, 1, 1.1),
       (1991, 2, 1.2),
       (1991, 3, 1.3),
       (1991, 4, 1.4),
       (1992, 1, 2.1),
       (1992, 2, 2.2),
       (1992, 3, 2.3),
       (1992, 4, 2.4);

select *
from table2;
```

```sql
-- ä¸´æ—¶è¡¨å†™æ³•
with temp as (select *,
                   if(month = 1, amount, 0) as a,
                   if(month = 2, amount, 0) as b,
                   if(month = 3, amount, 0) as c,
                   if(month = 4, amount, 0) as d
            from table2)
select year, sum(a) m1 , sum(b) m2, sum(c) m3, sum(d) m4
from temp
group by year;

-- å­æŸ¥è¯¢å†™æ³•
select year, sum(a) m1, sum(b) m2, sum(c) m3, sum(d) m4
from (select *,
             if(month = 1, amount, 0) as a,
             if(month = 2, amount, 0) as b,
             if(month = 3, amount, 0) as c,
             if(month = 4, amount, 0) as d
      from table2) t
group by year;

-- ç®€åŒ–å†™æ³•
SELECT year,
       SUM(IF(month = 1, amount, 0)) AS m1,
       SUM(IF(month = 2, amount, 0)) AS m2,
       SUM(IF(month = 3, amount, 0)) AS m3,
       SUM(IF(month = 4, amount, 0)) AS m4
FROM table2
GROUP BY year;
```

å¯ä»¥çœ‹çœ‹tempçš„æ•°æ®ï¼š

![image-20240808122505153](img/%E6%89%8B%E6%92%95%E9%9D%A2%E8%AF%95/image-20240808122505153.png)

```sql
with temp as () -- ä¸´æ—¶è¡¨
if(æ¡ä»¶, çœŸå€¼ï¼Œå‡å€¼) -- ä¸‰ç›®è¡¨è¾¾å¼
```

### å¸¦è¿æ¥

```sql
-- æŸ¥è¯¢è¯¾ç¨‹ç¼–å·â€œ2â€çš„æˆç»©æ¯”è¯¾ç¨‹ç¼–å·â€œ1â€ä½çš„æ‰€æœ‰åŒå­¦çš„å­¦å·ã€å§“åã€‚
select sid, sname
from (select student_id,
             sum(if(course_id = 2, number, 0)) as cs2,
             sum(if(course_id = 1, number, 0)) as cs1
      from score
      group by student_id
      having cs2 < cs1) t1
         join student s on t1.student_id = s.sid;

-- ä¸´æ—¶è¡¨å†™æ³•
with temp as (select student_id,
                     sum(if(course_id = 2, number, 0)) as cs2,
                     sum(if(course_id = 1, number, 0)) as cs1
              from score
              group by student_id
              having cs2 < cs1)
select student.sid, student.sname
from temp
         join student
              on temp.student_id = student.sid;
```

### æ•°ä¸ªæ•° group by + count(if(exp, true_val, null))

è¡¨tableå¦‚ä¸‹ï¼š

| DDate      | shengfu |
| ---------- | ------- |
| 2015-05-09 | èƒœ      |
| 2015-05-09 | èƒœ      |
| 2015-05-09 | è´Ÿ      |
| 2015-05-09 | è´Ÿ      |
| 2015-05-10 | èƒœ      |
| 2015-05-10 | è´Ÿ      |
| 2015-05-10 | è´Ÿ      |

å¦‚æœè¦ç”Ÿæˆä¸‹åˆ—ç»“æœ, è¯¥å¦‚ä½•å†™sqlè¯­å¥?

| DDate      | èƒœ   | è´Ÿ   |
| ---------- | ---- | ---- |
| 2015-05-09 | 2    | 2    |
| 2015-05-10 | 1    | 2    |

 ```sql
 create table table1
 (
     DDate   varchar(20),
     shengfu varchar(20)
 );
 insert into table1
 values ('2015-05-09', "èƒœ"),
        ('2015-05-09', "èƒœ"),
        ('2015-05-09', "è´Ÿ"),
        ('2015-05-09', "è´Ÿ"),
        ('2015-05-10', "èƒœ"),
        ('2015-05-10', "è´Ÿ"),
        ('2015-05-10', "è´Ÿ");
 -- count é‡Œé¢å¿…é¡»æ˜¯ nullï¼æ•°énullçš„ä¸ªæ•°
 select DDate,
        count(if(shengfu = "èƒœ", 1, null)) as win,
        count(if(shengfu = "è´Ÿ", 1, null)) as lose
 from table1
 group by DDate;
 -- sum
 select DDate,
        sum(if(shengfu = "èƒœ", 1, 0)) as win,
        sum(if(shengfu = "è´Ÿ", 1, 0)) as lose
 from table1
 group by DDate;
 ```

### å¸¦å­—ç¬¦ä¸²æ‹¼æ¥

```sql
create table tableA
(
    qq   varchar(20),
    game varchar(20)
);
insert into tableA
values (10000, 'a'),
       (10000, 'b'),
       (10000, 'c'),
       (20000, 'c'),
       (20000, 'd');

create table tableB
(
    qq   varchar(20),
    game varchar(20)
);
insert into tableB
values (10000, 'a_b_c'),
       (20000, 'c_d');
       
-- A to B
select qq,
       group_concat(game SEPARATOR '_') as game
from tableA
group by qq;
```

## è¿ç»­Nå¤©ç™»é™†

### æŸ¥è¯¢å‡ºè¿ç»­ä¸‰å¤©ç™»å½•çš„äººå‘˜å§“å

![image-20240808132135725](img/%E6%89%8B%E6%92%95%E9%9D%A2%E8%AF%95/image-20240808132135725.png)

æ€è·¯ï¼š

1. å…ˆå»é‡
2. å¾—åˆ°rnï¼Œ row numberï¼ˆpartition by name order by date)
3. date-rn -ã€‹ date_sub(interval rn day) date2
4. æŒ‰ç…§date2, name åˆ†ç»„
5. count å¤§äºNå¤©çš„
6. å»é‡name

```sql
with t1 as (select distinct name, date
            from game), -- å»é‡
     t2 as (select *,
                   row_number() over (partition by name order by date) rn
            from t1), -- å¾—åˆ°rn
     t3 as (select *, date_sub(date, interval rn day) date2
            from t2) -- date - rn
select distinct name
from t3
group by name, date2 -- åˆ†ç»„
having count(1) >= 3;-- è®¡æ•°
```

### è¿‡å»ä¸€ä¸ªæœˆå†…,æ›¾è¿ç»­ä¸¤å¤©æ´»è·ƒçš„ç”¨æˆ·

```sql
-- å»ºè¡¨
-- è¡¨1 dau   è®°å½•äº†æ¯æ—¥è„‰è„‰æ´»è·ƒç”¨æˆ·çš„uidå’Œä¸åŒæ¨¡å—çš„æ´»è·ƒæ—¶é•¿
create table dau
(
    d               varchar(20),
    uid             int,
    module          varchar(20),
    active_duration int
);
insert into dau
values ('2024-08-01', 1, 'jobs', 324),
       ('2024-08-01', 2, 'feeds', 445),
       ('2024-08-01', 3, 'im', 345),
       ('2024-08-02', 2, 'network', 765),
       ('2024-08-02', 3, 'jobs', 342);
select *
from dau;

with t1 as (select DISTINCT d, uid
            from dau), -- å…ˆ å»é‡
     t2 as (select *,
                   date_sub(d, interval (row_number() over (partition by uid order by d)) day) dis -- date - rn(partition by uid order by d)
            from t1
            where d <= CURRENT_DATE() -- ç­›é€‰ä¸€ä¸ªæœˆä»¥å†…çš„
              and d >= date_sub((CURRENT_DATE()), interval 30 day)),
     t3 as (select uid,
                   min(d)   `å¼€å§‹æ—¥æœŸ`,
                   max(d)   `ç»“æŸæ—¥æœŸ`,
                   count(1) `è¿ç»­ç™»å…¥å¤©æ•°`
            from t2
            group by uid, dis
            having count(*) >= 2)
select *
from t3;
```

![image-20240808135012384](img/%E6%89%8B%E6%92%95%E9%9D%A2%E8%AF%95/image-20240808135012384.png)

### æ¯ä¸ªæœˆæ¯å¼ å¡è¿ç»­æ¶ˆè´¹çš„æœ€å¤§å¤©æ•°

æœ‰ä¸€å¼ è¡¨C_Tï¼ˆåˆ—ä¸¾äº†éƒ¨åˆ†æ•°æ®ï¼‰è¡¨ç¤ºæŒå¡äººæ¶ˆè´¹è®°å½•ï¼Œè¡¨ç»“æ„å¦‚ä¸‹ï¼š

| CARD NER  | VARCHAR2 | å¡å·ï¼Œ     |
| --------- | -------- | ---------- |
| C_MONTH   | NUMBER   | æ¶ˆè´¹æœˆä»½ï¼Œ |
| C_DATE    | DATE     | æ¶ˆè´¹æ—¥æœŸï¼Œ |
| C_TYPEVAR | CHAR2    | æ¶ˆè´¹ç±»å‹   |
| C_ATM     | NUMBER   | æ¶ˆè´¹é‡‘é¢   |

 æ¯ä¸ªæœˆæ¯å¼ å¡è¿ç»­æ¶ˆè´¹çš„æœ€å¤§å¤©æ•°ï¼ˆå¦‚å¡åœ¨å½“æœˆåªæœ‰ä¸€æ¬¡æ¶ˆè´¹åˆ™ä¸º1ï¼‰ã€‚

è¿ç»­æ¶ˆè´¹å¤©æ•°ï¼šæŒ‡ä¸€æ¥¼æ—¶é—´å†…è¿ç»­æ¯å¤©éƒ½æœ‰æ¶ˆè´¹ï¼ŒåŒä¸€å¤©æœ‰å¤šç¬”æ¶ˆè´¹ç®—ä¸€å¤©æ¶ˆè´¹ï¼Œä¸èƒ½è·¨æœˆä»½ç»Ÿè®¡ã€‚

```sql
create table c_t
(
    card_nbr varchar(20),
    c_month  varchar(20),
    c_date   varchar(20),
    c_type   varchar(20),
    c_atm    decimal
);
insert into c_t
values (1, '2022-01', '2022-01-01', 'ç½‘è´­', 100),
       (1, '2022-01', '2022-01-02', 'ç½‘è´­', 200),
       (1, '2022-01', '2022-01-03', 'ç½‘è´­', 300),
       (1, '2022-01', '2022-01-15', 'ç½‘è´­', 100),
       (1, '2022-01', '2022-01-16', 'ç½‘è´­', 200),
       (2, '2022-01', '2022-01-06', 'ç½‘è´­', 500),
       (2, '2022-01', '2022-01-07', 'ç½‘è´­', 800),
       (1, '2022-02', '2022-02-01', 'ç½‘è´­', 100),
       (1, '2022-02', '2022-02-02', 'ç½‘è´­', 200),
       (1, '2022-02', '2022-02-03', 'ç½‘è´­', 300),
       (2, '2022-02', '2022-02-06', 'ç½‘è´­', 500),
       (2, '2022-02', '2022-02-07', 'ç½‘è´­', 800);

select *
from c_t;

-- å»é‡ -> card_nbr,c_monthç»‘å®š å¾—åˆ°rn -> date_sub -> count -> æŒ‰ç…§cnté™åºåˆ†ç»„å¾—åˆ°ç¬¬ä¸€ä¸ª rn = 1
with t1 as (select distinct card_nbr, c_month, c_date from c_t),
     t2 as (select *, row_number() over (partition by card_nbr,c_month order by c_date) rn from t1),
     t3 as (select *, date_sub(c_date, interval rn day) dt2 from t2),
     t4 as (select dt2, card_nbr, c_month, count(1) cnt from t3 group by dt2, card_nbr, c_month),
     t5 as (select *, row_number() over (partition by card_nbr,c_month order by cnt desc) as rn from t4)
select card_nbr, c_month, cnt
from t5
where rn = 1;
```

## åˆ†ç»„å†…topå‰å‡ 

* éœ€æ±‚å¸¸è§è¯ï¼šã€æ¯ç»„xxxçš„ç¬¬ä¸€ä¸ªyyyçš„zzzã€‘ã€æ¯ç»„xxxçš„æœ€åä¸€ä¸ªã€‘

  ã€æ¯ç»„xxxçš„å‰nä¸ªã€‘ã€æ¯ç»„æœ€xxçš„å‰nä¸ªã€‘

* å…¬å¼ï¼šrow_number() over(partition by ç»„å)  as rnï¼Œå†ç­›é€‰rn<=Nå

### æ±‚å‡ºæ¯ä¸ªéƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‰ä¸‰åå‘˜å·¥

å‘˜å·¥å·¥å·ï¼Œ å‘˜å·¥å§“åï¼Œå…¥èŒæ—¥æœŸï¼Œå‘˜å·¥è–ªæ°´ï¼Œéƒ¨é—¨ç¼–å·

<img src="img/%E6%89%8B%E6%92%95%E9%9D%A2%E8%AF%95/image-20240808140603393.png" alt="image-20240808140603393" style="zoom:50%;" />

é¢˜ç›®æè¿°

æ±‚å‡ºæ¯ä¸ªéƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‰ä¸‰åå‘˜å·¥ï¼Œå¹¶è®¡ç®—è¿™äº›å‘˜å·¥çš„å·¥èµ„å æ‰€å±éƒ¨é—¨æ€»å·¥èµ„çš„ç™¾åˆ†æ¯”ã€‚

```sql
select temp.empno, temp.ename, temp.sal, temp.rn, temp.sum_sal, round(temp.sal / temp.sum_sal, 2) as rate
from (select *,
             row_number() over (partition by deptno order by sal desc) rn,
             sum(sal) over (partition by deptno)                  sum_sal
      from emp) temp
where rn <= 3;
```

å­æŸ¥è¯¢çš„ç»“æœå¦‚ä¸‹ï¼š

<img src="img/%E6%89%8B%E6%92%95%E9%9D%A2%E8%AF%95/image-20240808141510124.png" alt="image-20240808141510124" style="zoom:50%;" />

### 20201201è‡³ä»Šæ¯æ—¥è®¢å•é‡top10çš„åŸå¸‚åŠå…¶è®¢å•é‡

è®¢å•è¡¨ï¼Œtorder.  å­—æ®µï¼Œuser_id, order_id, ctime(10ä½æ—¶é—´æˆ³)ï¼Œcity idï¼Œsale_numï¼Œsku_id(å•†å“)

```sql
create table t_order (user_id string, 
                      order_id string, 
                      ctime string, 
                      city_id string, 
                      sale_num int , 
                      sku_id string) ;
with t1 as (select to_date(ctime) cdate, city_id, count(distinct order_id) cnt
            from t_order
            where to_date(ctime) >= '2020-12-01'
              and to_date(ctime) <= `current_date`()
            group by to_date(ctime), city_id),
     t2 as (select *, row_number() over (partition by cdate order by cnt desc) rn from t1)
select cdate, city_id, cnt
from t2
where rn <= 10;

-- mysql : select str_to_date('20220101', '%Y%m%d')
```

## çª—å£å‡½æ•°

overå…³é”®å­— ä»£è¡¨å®šä¹‰çª—å£

ç”¨æ³•ï¼šå‡½æ•°åï¼ˆå­—æ®µåï¼‰over (partition by xxx, yyy order by zzz)

- èšåˆç±»çª—å£å‡½æ•°
  - Sum() over()
  - Count/avg/max/min 
- æ’åºç±»
  - Row_number/ rank/ dense_rank
- åç§»ç±»
  - Lag/ lead

Empè¡¨çš„è¡¨æ•°æ®å¦‚ä¸‹ï¼š

| NAME | MONTH | AMT  |
| ---- | ----- | ---- |
| å¼ ä¸‰ | 01    | 100  |
| æå›› | 02    | 120  |
| ç‹äº” | 03    | 150  |
| èµµå…­ | 04    | 500  |
| å¼ ä¸‰ | 05    | 400  |
| æå›› | 06    | 350  |
| ç‹äº” | 07    | 180  |
| èµµå…­ | 08    | 400  |

é—®é¢˜ï¼šè¯·å†™å‡ºå¯ä»¥å¾—åˆ°ä»¥ä¸‹çš„ç»“æœSQL

| NAME | æ€»é‡‘é¢ | æ’å | å æ¯”   |
| ---- | ------ | ---- | ------ |
| èµµå…­ | 900    | 1    | 40.91% |
| å¼ ä¸‰ | 500    | 2    | 22.73% |
| æå›› | 470    | 3    | 21.36% |
| ç‹äº” | 330    | 4    | 15.00% |

```sql
with t1 as (select name,
                   sum(amt) sum_amt
            from emp
            group by name),
     t2 as (select *,
                   row_number() over (order by sum_amt desc) rn,
                   sum_amt / sum(sum_amt) over ()            rate
            from t1)
select name as 'å§“å', sum_amt as 'æ€»é‡‘é¢', rn as 'æ’å', concat(round(rate * 100, 2), '%') as 'å æ¯”'
from t2;
```

åœ¨ç¬¬ä¸€é¢˜å‘˜å·¥è¡¨çš„åŸºç¡€ä¸Šï¼Œç»Ÿè®¡æ¯å¹´å…¥èŒæ€»æ•°ä»¥åŠæˆªè‡³æœ¬å¹´ç´¯è®¡å…¥èŒæ€»äººæ•°ã€‚

æˆªè‡³æœ¬å¹´ç´¯è®¡å…¥èŒæ€»äººæ•°=æœ¬å¹´æ€»å…¥èŒäººæ•° + æœ¬å¹´ä¹‹å‰æ‰€æœ‰å¹´çš„æ€»å…¥èŒäººæ•°ä¹‹å’Œ

<img src="img/%E6%89%8B%E6%92%95%E9%9D%A2%E8%AF%95/image-20240808144256360.png" alt="image-20240808144256360" style="zoom:50%;" />

```sql
select *,
       sum(cnt) over (order by year1) cnt2
from
    (select year(hiredate) as year1,
            count(1) as cnt
     from emp
     group by year(hiredate)) a;
```

## å¸¦æ¡ä»¶çš„èšåˆç»Ÿè®¡

è¦æ±‚ï¼šç¼–å†™SQLèƒ½è¿è¡Œï¼Œæ•°æ®æ­£ç¡®ä¸”ç¬¦åˆè§„èŒƒï¼Œå¦‚é‡åˆ°è‡ªå®šä¹‰å‡½æ•°æˆ–ä¸è®°å¾—çš„å‡½æ•°å¯ä»¥ç”¨XXä»£æ›¿

1.å·²çŸ¥æœ‰å¦‚ä¸‹ä¸¤ä¸ªè¡¨è¡¨saleï¼šå­—æ®µå¦‚ä¸‹

```sql
Create table sale_order(
    Order_id bigint comment 'è®¢å•ID',
    User_id bigint comment 'ç”¨æˆ·ID',
    Order_status int,
    Create_time string,
    Last_update_time string,
    Product_id bigint,
    Product_num bigint 
);
```

ç”¨æˆ·æ³¨å†Œè¡¨ï¼š

```sql
Create table user_info(
    user_id bigint comment'ç”¨æˆ·IDï¼Œå”¯ä¸€ä¸»é”®',
    sex string.
    age int
);

```

é—®é¢˜ï¼šç”¨ä¸€æ¡SQLç”Ÿæˆå®Œæ•´çš„ç”¨æˆ·ç”»åƒè¡¨ï¼ŒåŒ…å«å¦‚ä¸‹å­—æ®µï¼š

user_id,  sex,  age,  d7order_num,   d14_order_numï¼Œåé¢ä¸¤ä¸ªå­—æ®µåˆ†åˆ«ä¸ºè¿‘7å¤©è®¢å•æ•°é‡ï¼Œè¿‘14å¤©è®¢å•æ•°é‡ã€‚

```sql
create table sale_order(
    order_id bigint comment 'è®¢å•ID',
    user_id bigint comment 'ç”¨æˆ·ID',
    order_status int ,
    create_time string,
    last_update_time string,
    product_id bigint,
    product_num bigint
);
create table user_info(
    user_id bigint comment 'ç”¨æˆ·ID,å”¯ä¸€ä¸»é”®',
    sex string,
    age int
);

select u.user_id,
       s.d7order_num,
       s.d14order_num
from user_info u
left join (select user_id,
                  count(if(create_time >= '7å¤©å‰'  and create_time <= 'ä»Šå¤©', order_id,null)) as d7order_num,
                  count(if(create_time >= '14å¤©å‰' and create_time <= 'ä»Šå¤©', order_id,null)) as d14order_num
           from sale_order
           where create_time >= '14å¤©å‰'
           group by user_id) s on u.user_id = s.user_id;
```

# hot100

## å“ˆå¸Œ

[1. ä¸¤æ•°ä¹‹å’Œ](https://leetcode.cn/problems/two-sum/) a[i] + a[j] = t  æšä¸¾iï¼Œæ‰¾åˆ° t - a[i] æ˜¯å¦å­˜åœ¨ï¼Œ ç”±äºéœ€è¦è¿”å›ä¸‹æ ‡ï¼Œæ‰€ä»¥mapå­˜å‚¨(t - a[i], i)

- ç±»ä¼¼çš„è¿˜æœ‰ å’Œä¸ºkçš„å­æ•°ç»„ ï¼ˆç­‰ä»·äº s[j] - s[i] = k) å‰ç¼€å’Œçš„æ€æƒ³

[49. å­—æ¯å¼‚ä½è¯åˆ†ç»„](https://leetcode.cn/problems/group-anagrams/)

- **å­—æ¯å¼‚ä½è¯** æ˜¯ç”±é‡æ–°æ’åˆ—æºå•è¯çš„æ‰€æœ‰å­—æ¯å¾—åˆ°çš„ä¸€ä¸ªæ–°å•è¯ã€‚eat tea tae
- char[] w = s.toCharArray(), Arrays.sort(w), String s = String.valueOf(w) æ‹¿åˆ°ç›¸åŒçš„å•è¯ï¼Œå†ç”¨å“ˆå¸Œè¡¨åˆ¤æ–­å°±æ˜¯äº†
- ç”¨ map.computeIfAbsent(key, e -> new ArrayList<>()).add(val); å»ç®€åŒ–åˆ¤æ–­
- new ArrayList<>(map.values()) è¿”å›ä¸€ä¸ªList<List<>

ï¼ˆâŒï¼‰[128. æœ€é•¿è¿ç»­åºåˆ—](https://leetcode.cn/problems/longest-consecutive-sequence/)

ç»™å®šä¸€ä¸ªæœªæ’åºçš„æ•´æ•°æ•°ç»„ `nums` ï¼Œæ‰¾å‡ºæ•°å­—è¿ç»­çš„æœ€é•¿åºåˆ—ï¼ˆä¸è¦æ±‚åºåˆ—å…ƒç´ åœ¨åŸæ•°ç»„ä¸­è¿ç»­ï¼‰çš„é•¿åº¦ã€‚è¯·ä½ è®¾è®¡å¹¶å®ç°æ—¶é—´å¤æ‚åº¦ä¸º `O(n)` çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜ã€‚

- è¦æ±‚O(N)çš„ç®—æ³•ï¼Œå°±ä¸èƒ½ç”¨æ’åºäº†
- æ€è·¯ï¼š1. å…¥setï¼Œ2ï¼Œéå†æ¯ä¸ªå…ƒç´ ï¼Œåˆ¤æ–­å½“å‰æ˜¯ä¸æ˜¯èµ·ç‚¹ï¼ˆset.contains(x -1 ))ï¼Œå¦‚æœæ˜¯èµ·ç‚¹ï¼Œ å°±ä»åé¢æ‰¾while(set.contains(++x)) cur ++ï¼Œå¦‚æœä¸æ˜¯èµ·ç‚¹çš„è¯ï¼Œä¸€å®šä¼šæœ‰ä¸€æ¬¡å·²ç»åŒ…æ‹¬è¿›å»ï¼Œä¸éœ€è¦é‡å¤è®¡ç®—ã€‚

## åŒæŒ‡é’ˆ

[283. ç§»åŠ¨é›¶](https://leetcode.cn/problems/move-zeroes/)

- ç»å…¸åŒæŒ‡é’ˆï¼Œ æŒ‡é’ˆiæŒ‡å‘å…ƒç´ å­˜æ”¾ä½ç½®ï¼Œ æŒ‡é’ˆjå¾€åæ‰«ï¼Œä¸æ˜¯0çš„è¯ï¼Œå¡«åˆ°iä¸Šï¼Œæœ€åè®°å¾—å¡«å……iä¹‹åçš„

[11. ç››æœ€å¤šæ°´çš„å®¹å™¨](https://leetcode.cn/problems/container-with-most-water/)

- iï¼Œ jå¾€ä¸­é—´æ‰«ï¼Œæ¯æ¬¡æ›´æ–°ans=max(ans, min(h[i],h[j]) * (j - i))ï¼Œ æˆªæ­¢æ¡ä»¶æ˜¯ï¼ši == j æ‰€ä»¥ while(i < j)

ï¼ˆâŒï¼‰[15. ä¸‰æ•°ä¹‹å’Œ](https://leetcode.cn/problems/3sum/)

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸‰å…ƒç»„ `[nums[i], nums[j], nums[k]]` æ»¡è¶³ `i != j`ã€`i != k` ä¸” `j != k` ï¼ŒåŒæ—¶è¿˜æ»¡è¶³ `nums[i] + nums[j] + nums[k] == 0` ã€‚è¯·ä½ è¿”å›æ‰€æœ‰å’Œä¸º `0` ä¸”ä¸é‡å¤çš„ä¸‰å…ƒç»„ã€‚

**æ³¨æ„ï¼š**ç­”æ¡ˆä¸­ä¸å¯ä»¥åŒ…å«é‡å¤çš„ä¸‰å…ƒç»„ã€‚

- å›ºå®šiï¼Œ æ‰¾åˆ°æ»¡è¶³nums[j] + nums[k] == -nums[i]çš„æ•°ï¼Œ åé¢è¿™ä¸€æ­¥å¯ä»¥ç”¨åŒæŒ‡é’ˆå»æ‰¾
- é—®é¢˜1: å¦‚ä½•ä¸é‡å¤ï¼Œå¦‚æœnums[i]å’Œå‰é¢çš„æ•°ç›¸åŒï¼Œå°±ä¸åšå¤„ç†äº†i > 0 && nums[i] == nums[i - 1]
- é—®é¢˜2ï¼šæ€ä¹ˆå‰ªçº¸ ifï¼ˆnums[i] > 0) å› ä¸ºæœ‰åºï¼Œ æ‰€ä»¥ç¬¬ä¸€ä¸ªæ•°>0äº†ï¼Œåé¢å¿…ç„¶ä¸å¯èƒ½
- é—®é¢˜3: iå’Œjçš„ç›¸åŒæ•°è·³è¿‡çš„é€»è¾‘: while(l < r && nums[l] == nums[l + 1])l ++; æœ€åè¿˜è¦ä¸€æ¬¡l ++;

ï¼ˆâŒï¼‰[42. æ¥é›¨æ°´](https://leetcode.cn/problems/trapping-rain-water/)

<img src="img/%E6%89%8B%E6%92%95%E9%9D%A2%E8%AF%95/image-20240813164145786.png" alt="image-20240813164145786" style="zoom:50%;" />

- æ€ä¹ˆå®šä¹‰å¯ä»¥æ¥åˆ°çš„é›¨æ°´é¢ç§¯ï¼š å‡è®¾å½“å‰xï¼Œmin(å·¦è¾¹æ¯”xå¤§çš„æœ€å¤§å€¼, å³è¾¹æ¯”xå¤§çš„æœ€å¤§å€¼ï¼‰ - x

```java
class Solution {
    public int trap(int[] h) {
        int n = h.length;
        if(n <= 2) return 0;
        int[] l = new int[n];
        int[] r = new int[n];

        l[0] = h[0]; r[n - 1] = h[n - 1];
        for(int i = 1; i < n; i ++) l[i] = Math.max(h[i], l[i - 1]);
        for(int i = n - 2; i >= 0; i --) r[i] = Math.max(h[i], r[i + 1]);

        int res = 0;
        for(int i = 0; i < n; i ++) {
            res += Math.min(l[i], r[i]) - h[i];
        }
        return res;
    }
}
```

## æ»‘åŠ¨çª—å£

[3. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²](https://leetcode.cn/problems/longest-substring-without-repeating-characters/)

ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² `s` ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ **æœ€é•¿ å­ä¸²** çš„é•¿åº¦ã€‚

- æ»‘åŠ¨çª—å£çš„åŸºæœ¬æ¨¡ç‰ˆ

  ```java
  class Solution {
      public int lengthOfLongestSubstring(String s) {
          char[] w = s.toCharArray();
          int res = 0;
          int n = w.length;
          int[] cnt = new int[128];
          for(int i = 0, j = 0; i < n; i ++) {
              cnt[w[i]] ++;
              while(cnt[w[i]] > 1) { // ä¸æ»¡è¶³æ¡ä»¶ å¼€å§‹ç§»å·¦æŒ‡é’ˆ
                  cnt[w[j ++]] --;
              }
            // é€€å‡ºå¾ªç¯ è¡¨ç¤ºæ­¤æ—¶çª—å£æ»¡è¶³whileæ¡ä»¶
              res = Math.max(res, i - j + 1);
          }
          return res;
      }
  }
  ```
  

ï¼ˆâŒï¼‰[438. æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯](https://leetcode.cn/problems/find-all-anagrams-in-a-string/)

ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² `s` å’Œ `p`ï¼Œæ‰¾åˆ° `s` ä¸­æ‰€æœ‰ `p` çš„ **å¼‚ä½è¯** çš„å­ä¸²ï¼Œè¿”å›è¿™äº›å­ä¸²çš„èµ·å§‹ç´¢å¼•ã€‚ä¸è€ƒè™‘ç­”æ¡ˆè¾“å‡ºçš„é¡ºåºã€‚

**å¼‚ä½è¯** æŒ‡ç”±ç›¸åŒå­—æ¯é‡æ’åˆ—å½¢æˆçš„å­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬ç›¸åŒçš„å­—ç¬¦ä¸²ï¼‰ã€‚

```java
class Solution {
    public List<Integer> findAnagrams(String s, String p) {
        int[] pCnt = new int[26];
        // å­—ç¬¦çš„ç§ç±»ã€æ¯ä¸ªç§ç±»çš„ä¸ªæ•°éƒ½è¦ç›¸åŒ
        List<Integer> res = new ArrayList<>();
        char[] ws = s.toCharArray();
        char[] ps = p.toCharArray();
        for(char x : ps) {
            pCnt[x - 'a'] ++;
        }
        
        for(int i = 0, j = 0; i < ws.length; i ++) {
            pCnt[ws[i] - 'a'] --;
            while(pCnt[ws[i] - 'a'] < 0) {
                pCnt[ws[j ++] - 'a'] ++;
            }
          // æ»¡è¶³æ¬¡æ•°æ¡ä»¶ï¼Œ æ£€æŸ¥æ˜¯å¦æ»¡è¶³ é•¿åº¦æ¡ä»¶
            if(i - j + 1 == ps.length) {
                res.add(j);
            }
        }
        return res;
    }
}
```

## å­ä¸²

ï¼ˆâŒï¼‰[560. å’Œä¸º K çš„å­æ•°ç»„](https://leetcode.cn/problems/subarray-sum-equals-k/)

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªæ•´æ•° `k` ï¼Œè¯·ä½ ç»Ÿè®¡å¹¶è¿”å› è¯¥æ•°ç»„ä¸­å’Œä¸º `k` çš„å­æ•°ç»„çš„ä¸ªæ•°ã€‚å­æ•°ç»„æ˜¯æ•°ç»„ä¸­å…ƒç´ çš„è¿ç»­éç©ºåºåˆ—ã€‚

```java
class Solution {
    public int subarraySum(int[] nums, int k) {
        // s[j] - s[i] = k
        // æ‰¾åˆ°æ˜¯å¦æ»¡è¶³ s[i] + k = s[j]
        
        // s[j] - k
        int n = nums.length;
        int[] s = new int[n + 1];
        for(int i = 1; i <= n; i ++) {
            s[i] = s[i - 1] + nums[i - 1];
        }
        int ans = 0;
        Map<Integer, Integer> cnt = new HashMap<>();
        for(int x : s) {
            ans += cnt.getOrDefault(x - k, 0);
            cnt.merge(x, 1, Integer::sum);
        }
        return ans;
    }
}
```

ï¼ˆâŒï¼‰[239. æ»‘åŠ¨çª—å£æœ€å¤§å€¼](https://leetcode.cn/problems/sliding-window-maximum/)

<img src="img/%E6%89%8B%E6%92%95%E9%9D%A2%E8%AF%95/image-20240813212610645.png" alt="image-20240813212610645" style="zoom:50%;" />

- æš´åŠ›åšæ³•ï¼Œå¯¹äºæ¯ä¸ªæ»‘åŠ¨çª—å£ï¼Œokçš„æ—¶é—´å¤æ‚åº¦æ‰¾åˆ°æœ€å¤§å€¼
- ä¼˜å…ˆé˜Ÿåˆ—åšæ³•ï¼Œç»´æŠ¤å¤§æ ¹å †
- å•è°ƒé˜Ÿåˆ—ï¼šå†…æ¶µï¼šæ¯è¿‡ä¸€å¹´ï¼Œé˜Ÿä¼é‡Œå¹´é¾„è¶…å‡ºæ—¶é—´åŒºé—´çš„è¸¢äº†ï¼Œé˜Ÿå°¾èƒ½åŠ›å°äºæ–°äººçš„ä¹Ÿè¸¢äº†ï¼ç„¶ååŠ å…¥æ–°äººï¼æ–°äººä¸€å®šå¾—æ˜¯é˜Ÿä¼é‡Œæœ€å¹´è½»ï¼ˆä¸‹æ ‡æœ€é å³ï¼‰ä¸”èƒ½åŠ›æœ€å¼±ï¼ˆå€¼æœ€å°ï¼‰çš„ï¼Œå¦‚æœæœ‰æ¯”æ–°äººèƒ½åŠ›è¿˜å¼±çš„å‰è¾ˆï¼Œå¯¹ä¸èµ·äº†ï¼Œæ“åˆ€ï¼

```java
class Solution {
    public int[] maxSlidingWindow(int[] nums, int k) {
        int n = nums.length;
        int[] ans = new int[n - k + 1];
        Deque<Integer> q = new ArrayDeque<>();
        for(int i = 0; i < n; i ++ ){
            // æ·˜æ±°é˜Ÿå°¾æ¯”æ–°äººèƒ½åŠ›å¼±çš„
            while(!q.isEmpty() && nums[q.getLast()] <= nums[i]) {
                q.removeLast();
            }
            // åŠ å…¥æ–°äºº
            q.addLast(i);
            // åˆ¤æ–­è€äººåˆæ²¡æœ‰è¶…å‡ºæ—¶é—´
            if(i - q.getFirst() >= k) {
                q.removeFirst();
            }

            // è®°å½•ç­”æ¡ˆ
            if(i >= k - 1) {
                ans[i - (k - 1)] = nums[q.getFirst()];
            }
        }
        return ans;
    }
}
```

ï¼ˆâŒï¼‰[76. æœ€å°è¦†ç›–å­ä¸²](https://leetcode.cn/problems/minimum-window-substring/)

```java
class Solution {
    public String minWindow(String S, String t) {
        char[] s = S.toCharArray();
        int n = s.length;
        int l = -1, r = n;
        int[] cntS = new int[128];
        int[] cntT = new int[128];
        for(char c : t.toCharArray()) {
            cntT[c]++;
        }
        
        for(int i = 0, j = 0; i < n; i ++) {
            cntS[s[i]]++;
          // è¿™éƒ¨åˆ†å¯ä»¥ä¼˜åŒ–ï¼Œ ç”¨ä¸€ä¸ªå˜é‡å»åˆ¤æ–­ï¼Œåˆå§‹åŒ–çš„æ—¶å€™
          // è®°å½•æœ‰lessç§å­—æ¯çš„
          // æ¯æ¬¡ ++cntS[c] == cntT(c) less--
          // while(less == 0) { ... if(cntS[x]-- == cntT[x]) less++}
            while(isCovered(cntS, cntT)) {
                if(i - j < r - l) {
                    l = j;
                    r = i;
                }
                cntS[s[j++]]--;
            }
        }
        return l < 0 ? "" : S.substring(l, r + 1);
    }
    private boolean isCovered(int[] cntS, int[] cntT) {
        for(int i = 'A'; i <= 'Z'; i ++) {
            if(cntS[i] < cntT[i]) {
                return false;
            }
        }
        for(int i = 'a'; i <= 'z'; i ++) {
            if(cntS[i] < cntT[i]) {
                return false;
            }
        }
        return true;
    }
}
```

## æ™®é€šæ•°ç»„

[53. æœ€å¤§å­æ•°ç»„å’Œ](https://leetcode.cn/problems/maximum-subarray/)

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` ï¼Œè¯·ä½ æ‰¾å‡ºä¸€ä¸ªå…·æœ‰æœ€å¤§å’Œçš„è¿ç»­å­æ•°ç»„ï¼ˆå­æ•°ç»„æœ€å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œè¿”å›å…¶æœ€å¤§å’Œã€‚**å­æ•°ç»„**æ˜¯æ•°ç»„ä¸­çš„ä¸€ä¸ªè¿ç»­éƒ¨åˆ†ã€‚

- f[i] è¡¨ç¤ºä»¥iç»“å°¾çš„æœ€å¤§å­æ•°ç»„çš„å’Œ
- f[i] = nums[i] + max(f[i - 1], 0)
- è€ƒè™‘ä¼˜åŒ– ç”¨å˜é‡è¡¨ç¤ºä¹‹å‰çš„å’Œ

```java
class Solution {
    public int maxSubArray(int[] nums) {
        // -2 1 -3 4 -1 2 1 -5  4
        // -2 1 -2 4 3 5 6 1 5
        // f[i] è¡¨ç¤ºä»¥iç»“å°¾çš„æœ€å¤§å­æ•°ç»„å’Œ
        // f[i] = nums[i] + max(f[i - 1], 0)
        int n = nums.length;
        int[] f = new int[n];
        f[0] = nums[0];
        int ans = f[0];
        for(int i = 1; i < n; i ++) {
            f[i] = nums[i] + Math.max(f[i - 1], 0);
            ans = Math.max(ans, f[i]);
        }
        return ans;
    }
}

class Solution {
    public int maxSubArray(int[] nums) {
        int ans = nums[0];
        int pre = 0;
        for(int x : nums) {
            pre = Math.max(pre + x, x);
            ans = Math.max(ans, pre);
        }
        return ans;
    }
}
```

ï¼ˆâŒï¼‰[56. åˆå¹¶åŒºé—´](https://leetcode.cn/problems/merge-intervals/)

ä»¥æ•°ç»„ `intervals` è¡¨ç¤ºè‹¥å¹²ä¸ªåŒºé—´çš„é›†åˆï¼Œå…¶ä¸­å•ä¸ªåŒºé—´ä¸º `intervals[i] = [starti, endi]` ã€‚è¯·ä½ åˆå¹¶æ‰€æœ‰é‡å çš„åŒºé—´ï¼Œå¹¶è¿”å› ä¸€ä¸ªä¸é‡å çš„åŒºé—´æ•°ç»„ï¼Œè¯¥æ•°ç»„éœ€æ°å¥½è¦†ç›–è¾“å…¥ä¸­çš„æ‰€æœ‰åŒºé—´ã€‚

- æŒ‰æ¯ä¸ªå°åŒºé—´çš„èµ·ç‚¹å‡åºæ’åºï¼Œ ç»´æŠ¤startå’Œendæ˜¯å³å°†è¦åŠ å…¥listçš„åŒºé—´èµ·å§‹å’Œç»ˆç‚¹
- å¯¹äºæ¯ä¸ªåŒºé—´ï¼Œåˆ¤æ–­åŒºé—´çš„èµ·ç‚¹å’Œendï¼Œå¦‚æœèµ·ç‚¹ > endè¡¨ç¤ºä¸ç›¸äº¤ï¼ŒåŠ å…¥resï¼Œé‡æ–°è®¾ç½®startå’Œend
- å¦åˆ™ï¼Œå°±æŠŠendæ›´æ–°ä¸º å½“å‰ç»ˆç‚¹å’Œendçš„æœ€å¤§å€¼

```java
class Solution {
    public int[][] merge(int[][] its) {
        // æŒ‰ç…§its[0] æ’åº
        Arrays.sort(its, (o1, o2) -> o1[0] - o2[0]);
        
        List<int[]> ans = new ArrayList<>();
        int start = its[0][0];
        int end = its[0][1];

        for(int i = 1; i < its.length; i ++) {
            // å¦‚æœèµ·ç‚¹ > å‰ä¸€ä¸ªçš„endï¼Œå°±æŠŠå‰ä¸€ä¸ªåŠ å…¥
            if(its[i][0] > end) {
                ans.add(new int[]{start, end});
                start = its[i][0];
                end = its[i][1];
                continue;
            }
            
            end = Math.max(its[i][1], end);
            // å¦åˆ™ æœ‰è¦†ç›–ï¼Œend = max(cur_end, end)
        }
      // res.toArray(new int[res.size()][]);
        ans.add(new int[]{start, end});
        int size = ans.size();
        int[][] res = new int[size][2];
        for(int i = 0; i < size; i ++) {
            res[i] = ans.get(i);
        }
        return res;
    }
}
```

[189. è½®è½¬æ•°ç»„](https://leetcode.cn/problems/rotate-array/)

```
è¾“å…¥: nums = [1,2,3,4,5,6,7], k = 3
è¾“å‡º: [5,6,7,1,2,3,4]
```

- åŸåœ°ç®—æ³• swap(nums, 0, n -1 ) ; swap(nums, 0,k -1); swap(nums, k, n -1 )
- Oï¼ˆNï¼‰ç©ºé—´  new_arr[(i + k) % n] = nums[i]

[238. é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯](https://leetcode.cn/problems/product-of-array-except-self/)

```
è¾“å…¥: nums = [1,2,3,4]
è¾“å‡º: [24,12,8,6]
```

- ç±»ä¼¼å‰ç¼€å’Œçš„æ€æƒ³ï¼Œ é¢„å¤„ç†å‰åç¼€çš„ä¹˜ç§¯
- Oï¼ˆNï¼‰æ—¶é—´å¤æ‚åº¦

```java
class Solution {
    public int[] productExceptSelf(int[] nums) {
        int n = nums.length;
        int[] l = new int[n];
        int[] r = new int[n];
        
        l[0] = nums[0]; r[n - 1] = nums[n - 1];
        for(int i = 1; i < n; i ++) l[i] = l[i - 1] * nums[i];
        for(int i = n - 2; i >= 0; i --) r[i] = r[i + 1] * nums[i];
        // 1 2 6 24
        //24 24 12 4
        // å¯¹äºæ¯ä¸ªiä½ç½® res[i] = f[i - 1] * r[i + 1]
        int[] res = new int[n];
        res[0] = r[1];
        res[n - 1] = l[n - 2];
        for(int i = 1; i < n - 1; i ++) {
            res[i] = l[i - 1] * r[i + 1];
        }
        return res;
    }
}
```

[41. ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°](https://leetcode.cn/problems/first-missing-positive/)

pass

## çŸ©é˜µ

[73. çŸ©é˜µç½®é›¶](https://leetcode.cn/problems/set-matrix-zeroes/)

- æ€è·¯å°±æ˜¯ï¼Œ é¢„å¤„ç† è¡Œåˆ—æ˜¯å¦æœ‰0ï¼Œ èµ‹å€¼å³å¯Oï¼ˆM+Nï¼‰çš„é¢å¤–ç©ºé—´
- Oï¼ˆ1ï¼‰çš„æ€è·¯æ˜¯ï¼Œç”¨matrixçš„ç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—è®°å½•è¯¥è¡Œorè¯¥åˆ—æ˜¯å¦æœ‰0ï¼Œä½œä¸ºæ ‡å¿—ä½ã€‚ éœ€è¦ç‰¹åˆ¤æœ¬èº«è¡Œå’Œåˆ—æœ¬èº«å°±æœ‰0çš„æƒ…å†µï¼Œ1. è®°å½•ç¬¬ä¸€è¡Œå’Œåˆ—æœ¬èº«å°±æœ‰0çš„æ ‡è®° 2. åˆ¤æ–­å…¶ä»–ä½ç½® 3å…¶ä»–ç½®1 4.å¤„ç†ç¬¬ä¸€è¡Œåˆ—

[54. èºæ—‹çŸ©é˜µ](https://leetcode.cn/problems/spiral-matrix/)

- æ¨¡æ‹Ÿçš„æ€è·¯
- dfså››ä¸ªæ–¹å‘èµ°å‘çš„æ€è·¯

```java
class Solution {
    public List<Integer> spiralOrder(int[][] matrix) {
        int n = matrix.length, m = matrix[0].length;
        List<Integer> res = new ArrayList<>();
        int u = 0, d = n - 1, l = 0, r = m - 1;
        while(true) {
            for(int i = l; i <= r; i ++) res.add(matrix[u][i]);
            if(++ u > d) break; // é‡æ–°è®¾å®šä¸Šè¾¹ç•Œ
            for(int i = u; i <= d; i ++) res.add(matrix[i][r]);
            if(-- r < l) break; // é‡æ–°è®¾å®šå³è¾¹ç•Œ
            for(int i = r; i >= l; i --) res.add(matrix[d][i]);
            if(-- d < u) break; // é‡æ–°è®¾å®šä¸‹è¾¹ç•Œ
            for(int i = d; i >= u; i --) res.add(matrix[i][l]);
            if(++ l > r) break; // é‡æ–°è®¾å®šå·¦è¾¹ç•Œ
        }
        return res;
    }
}

class Solution {
    public List<Integer> spiralOrder(int[][] matrix) {
        int n = matrix.length, m = matrix[0].length;
        int[] dx = {0, 1, 0, -1};
        int[] dy = {1, 0, -1, 0};
        List<Integer> res = new ArrayList<>();
        boolean[][] st = new boolean[n][m];
        int x = 0, y = 0, d = 0;
        for(int i = 0; i < m * n; i ++) {
            res.add(matrix[x][y]);
            st[x][y] = true;
            
            // è®°å½•ä¸‹ä¸€ä¸ªä½ç½®
            int nx = x + dx[d];
            int ny = y + dy[d];
            if(nx < 0 || ny < 0 || nx >= n || ny >= m || st[nx][ny]) {
                d = (d + 1) % 4;
                nx = x + dx[d];
                ny = y + dy[d];
            } 
            x = nx;
            y = ny;
        }
        return res;
    }
}
```

[48. æ—‹è½¬å›¾åƒ](https://leetcode.cn/problems/rotate-image/)

- ä¸Šä¸‹ç¿»è½¬
- å¯¹è§’çº¿ç¿»è½¬

[240. æœç´¢äºŒç»´çŸ©é˜µ II](https://leetcode.cn/problems/search-a-2d-matrix-ii/)

ç¼–å†™ä¸€ä¸ªé«˜æ•ˆçš„ç®—æ³•æ¥æœç´¢ `m x n` çŸ©é˜µ `matrix` ä¸­çš„ä¸€ä¸ªç›®æ ‡å€¼ `target` ã€‚è¯¥çŸ©é˜µå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š

- æ¯è¡Œçš„å…ƒç´ ä»å·¦åˆ°å³å‡åºæ’åˆ—ã€‚
- æ¯åˆ—çš„å…ƒç´ ä»ä¸Šåˆ°ä¸‹å‡åºæ’åˆ—ã€‚

- å³ä¸Šè§’å¼€å§‹æœç´¢ï¼Œå¾€ä¸‹ or å·¦æœç´¢ï¼Œæœåˆ°å°±è¿”å›

```java
    public boolean searchMatrix(int[][] mat, int t) {
        int m = mat.length, n = mat[0].length;
        for(int i = 0, j = n - 1; i < m && j >= 0; ) {
            if(mat[i][j] == t) return true;
            if(mat[i][j] > t) j --;
            else i ++;
        }
        return false;
    }
```

## é“¾è¡¨

[160. ç›¸äº¤é“¾è¡¨](https://leetcode.cn/problems/intersection-of-two-linked-lists/)

- å“ˆå¸Œè¡¨ æ—¶é—´å¤æ‚åº¦O(max(m, n))
- å¾—åˆ°çŸ­é“¾è¡¨çš„é•¿åº¦ï¼Œä½œä¸ºæœ«å°¾ç›¸åŒæ¯”è¾ƒçš„ä¸€æ®µï¼Œå°†é•¿é“¾è¡¨çš„å¤´ç§»åŠ¨ï¼Œå¾ªç¯æ¯”è¾ƒ

```java
public class Solution {
    private ListNode solve(ListNode s, ListNode l, int dis) {
        while(dis-- > 0) l = l.next;
        while(s != null && l != null) {
            if(s == l) return s;
            s = s.next;
            l = l.next;
        }
        return null;
    }
    public ListNode getIntersectionNode(ListNode headA, ListNode headB) {
        //æœ«å°¾å¯¹é½
        int aLen = 0, bLen = 0;
        for(ListNode cur = headA; cur != null; cur = cur.next) aLen ++;
        for(ListNode cur = headB; cur != null; cur = cur.next) bLen ++;
        return aLen < bLen ? solve(headA, headB, bLen - aLen) : solve(headB, headA, aLen - bLen);
    }
}
```

[206. åè½¬é“¾è¡¨](https://leetcode.cn/problems/reverse-linked-list/)

- æ¨¡æ‹Ÿåšæ³•
- é€’å½’åšæ³•ï¼šhttps://leetcode.cn/problems/reverse-linked-list/solutions/36710/dong-hua-yan-shi-206-fan-zhuan-lian-biao-by-user74/

```java
class Solution {
    public ListNode reverseList(ListNode head) {
        ListNode pre = null, cur = head, nxt;
        while(cur != null) {
            nxt = cur.next;
            cur.next = pre;
            pre = cur;
            cur = nxt;
        }
        return pre;
    }
}
class Solution {
    public ListNode reverseList(ListNode head) {
        if(head == null || head.next == null) {
            return head;
        }
        ListNode cur = reverseList(head.next);
        head.next.next = head;
        head.next = null;
        return cur;
    }
}
```

[234. å›æ–‡é“¾è¡¨](https://leetcode.cn/problems/palindrome-linked-list/)

- Oï¼ˆNï¼‰æ—¶é—´ + Oï¼ˆNï¼‰ç©ºé—´å¤æ‚åº¦ï¼šç”¨ä¸€ä¸ªæ•°ç»„å­˜å‚¨ä¸€ä¸‹ï¼Œåˆ¤æ–­å›æ–‡æ•°ç»„
- Oï¼ˆNï¼‰æ—¶é—´ + Oï¼ˆ1ï¼‰ç©ºé—´å¤æ‚åº¦ï¼šåŒæŒ‡é’ˆ
  - æ‰¾åˆ°å‰åŠéƒ¨åˆ†çš„å°¾èŠ‚ç‚¹
  - ç¿»è½¬ååŠéƒ¨åˆ†é“¾è¡¨
  - åˆ¤æ–­æ˜¯å¦å›æ–‡
  - æ¢å¤é“¾è¡¨
  - è¿”å›ç»“æœ

```java
class Solution {
    public boolean isPalindrome(ListNode head) {
        if(head == null) return true;
        // æ‰¾åˆ°å‰ä¸€åŠçš„å°¾èŠ‚ç‚¹
        ListNode endOfFist = find(head);
        // ç¿»è½¬ååŠéƒ¨åˆ†ï¼Œå¹¶è¿”å›å¤´èŠ‚ç‚¹
        ListNode startOfSecond = reverseList(endOfFist.next);
        // æ¯”è¾ƒå›æ–‡
        ListNode p = head, q = startOfSecond;
        boolean result = true;
        while(q != null) {
            if(p.val != q.val) {
                result = false;
                break;
            }
            p = p.next;
            q = q.next;
        }
        // è¿˜åŸèŠ‚ç‚¹
        endOfFist.next = reverseList(startOfSecond);
        return result;
    }
    private ListNode reverseList(ListNode head) {
        if(head == null || head.next == null) return head;
        ListNode cur = reverseList(head.next);
        head.next.next = head;
        head.next = null;
        return cur;
    }
    private ListNode find(ListNode head) {
        ListNode fast = head, slow = head;
        while(fast.next != null && fast.next.next != null) {
            fast = fast.next.next;
            slow = slow.next;
        }
        return slow;
    }
}
```

[141. ç¯å½¢é“¾è¡¨](https://leetcode.cn/problems/linked-list-cycle/)

ç»™ä½ ä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ `head` ï¼Œåˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯ã€‚

å¦‚æœé“¾è¡¨ä¸­æœ‰æŸä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥é€šè¿‡è¿ç»­è·Ÿè¸ª `next` æŒ‡é’ˆå†æ¬¡åˆ°è¾¾ï¼Œåˆ™é“¾è¡¨ä¸­å­˜åœ¨ç¯ã€‚ ä¸ºäº†è¡¨ç¤ºç»™å®šé“¾è¡¨ä¸­çš„ç¯ï¼Œè¯„æµ‹ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨æ•´æ•° `pos` æ¥è¡¨ç¤ºé“¾è¡¨å°¾è¿æ¥åˆ°é“¾è¡¨ä¸­çš„ä½ç½®ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚**æ³¨æ„ï¼š`pos` ä¸ä½œä¸ºå‚æ•°è¿›è¡Œä¼ é€’** ã€‚ä»…ä»…æ˜¯ä¸ºäº†æ ‡è¯†é“¾è¡¨çš„å®é™…æƒ…å†µã€‚

*å¦‚æœé“¾è¡¨ä¸­å­˜åœ¨ç¯* ï¼Œåˆ™è¿”å› `true` ã€‚ å¦åˆ™ï¼Œè¿”å› `false` ã€‚

- å“ˆå¸Œè¡¨ï¼Œ éå†èŠ‚ç‚¹ åˆ¤æ–­æ˜¯å¦å·²ç»è®¿é—®è¿‡
- å¿«æ…¢æŒ‡é’ˆï¼Œ é¾Ÿå…”èµ›è·‘ç®—æ³•ï¼Œ å¿«æŒ‡é’ˆèµ°ä¸¤æ­¥ï¼Œæ…¢æŒ‡é’ˆèµ°ä¸€æ­¥ï¼Œ å¦‚æœæ²¡æœ‰ç¯ï¼Œ å¿«æŒ‡é’ˆä¸€å®šä¼šæå‰ç»ˆæ­¢åˆ°nullï¼Œå¦‚æœæœ‰ç¯ï¼Œ å¿«æŒ‡é’ˆä¼šä¼˜å…ˆè¿›å…¥ç¯ï¼Œæ…¢æŒ‡é’ˆéšåï¼Œ ä¹‹åå¿«æŒ‡é’ˆä¸€å®šä¼šåœ¨æŸä¸ªæ—¶é—´è¿½ä¸Šæ…¢æŒ‡é’ˆ å¥—åœˆ

```java
    public boolean hasCycle(ListNode head) {
        ListNode fast = head;
        ListNode slow = head;
        while(fast != null && fast.next != null) {
            slow = slow.next;
            fast = fast.next.next;
            if(slow == fast) return true;
        }
        return false;
    }
```

![image-20240814111311805](img/%E6%89%8B%E6%92%95%E9%9D%A2%E8%AF%95/image-20240814111311805.png)

ç›¸å¯¹ é€Ÿåº¦ ï¼Œ ä¸€å®šèƒ½è¿½ä¸Š

[142. ç¯å½¢é“¾è¡¨ II](https://leetcode.cn/problems/linked-list-cycle-ii/)

1. f=2s ï¼ˆå¿«æŒ‡é’ˆæ¯æ¬¡2æ­¥ï¼Œè·¯ç¨‹åˆšå¥½2å€ï¼‰
2. f = s + nb (ç›¸é‡æ—¶ï¼Œåˆšå¥½å¤šèµ°äº†nåœˆï¼‰

æ¨å‡ºï¼šs = nb

ä»headç»“ç‚¹èµ°åˆ°å…¥ç¯ç‚¹éœ€è¦èµ° ï¼š a + nbï¼Œ è€Œslowå·²ç»èµ°äº†nbï¼Œé‚£ä¹ˆslowå†èµ°aæ­¥å°±æ˜¯å…¥ç¯ç‚¹äº†ã€‚

å¦‚ä½•çŸ¥é“slowåˆšå¥½èµ°äº†aæ­¥ï¼Ÿ ä»headå¼€å§‹ï¼Œå’ŒslowæŒ‡é’ˆä¸€èµ·èµ°ï¼Œç›¸é‡æ—¶åˆšå¥½å°±æ˜¯aæ­¥

```java
public class Solution {
    public ListNode detectCycle(ListNode head) {
        ListNode fast = head, slow = head;
        while(fast != null && fast.next != null) {
            fast = fast.next.next;
            slow = slow.next;
            if(slow == fast) {
                fast = head;
                while(fast != slow) {
                    fast = fast.next;
                    slow = slow.next;
                }
                return fast;
            }
        }
        return null;
    }
}
```

[21. åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨](https://leetcode.cn/problems/merge-two-sorted-lists/)

- ä¸€ä¸€æ¯”è¾ƒ
- é€’å½’

```java
class Solution {
    public ListNode mergeTwoLists(ListNode list1, ListNode list2) {
        if(list1 == null) return list2;
        if(list2 == null) return list1;
        if(list1.val < list2.val) {
            list1.next = mergeTwoLists(list1.next, list2);
            return list1;
        }
        list2.next = mergeTwoLists(list1, list2.next);
        return list2;
    }
}
```

![image-20240814113220586](img/%E6%89%8B%E6%92%95%E9%9D%A2%E8%AF%95/image-20240814113220586.png)

[2. ä¸¤æ•°ç›¸åŠ ](https://leetcode.cn/problems/add-two-numbers/)

- ä¹Ÿæ˜¯æ¨¡æ‹Ÿå°±å¥½äº†ï¼Œè¿›ä½ï¼Œ æœ€åä¸€ä½å¦‚æœæ˜¯1çš„è¯ï¼Œ å†åŠ ä¸Š

[19. åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ N ä¸ªç»“ç‚¹](https://leetcode.cn/problems/remove-nth-node-from-end-of-list/)

- å¿«æ…¢æŒ‡é’ˆï¼Œå¿«æŒ‡é’ˆå…ˆèµ°Næ­¥ï¼Œ ï¼ˆå¦‚æœåˆ°äº†nullï¼Œè¯´æ˜åˆ ç¬¬ä¸€ä¸ªå°±è¡Œï¼‰ï¼Œ ä¹‹åï¼ŒåŒæ—¶èµ°ï¼Œç›´åˆ°fastçš„ä¸‹ä¸€æ­¥ä¸ºnullï¼Œæ­¤æ—¶slowå°±æ˜¯è¦åˆ çš„å‰ä¸€ä¸ªèŠ‚ç‚¹

[24. ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹](https://leetcode.cn/problems/swap-nodes-in-pairs/)

- preå’Œcuræ€ä¹ˆåˆ°ä¸‹ä¸€ä¸ªï¼Œå°±çœ‹ç¬¬ä¸€ä¸ªçš„ç›¸å¯¹ä½ç½®

- æ‰‹åŠ¨æ¨¡æ‹Ÿä¸€ä¸‹

```java
class Solution {
    public ListNode swapPairs(ListNode head) {
        ListNode dummy = new ListNode(-1);
        dummy.next = head;
        if(head == null || head.next == null) return head;
        ListNode p;
        ListNode pre = dummy;
        ListNode cur = head;
        while(cur != null && cur.next != null) {
            p = cur.next.next;
            cur.next.next = cur;
            pre.next = cur.next;
            cur.next = p;
            pre = cur;
            cur = p;
        }
        return dummy.next;
    }
}
```

[25. K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨](https://leetcode.cn/problems/reverse-nodes-in-k-group/)

[138. éšæœºé“¾è¡¨çš„å¤åˆ¶](https://leetcode.cn/problems/copy-list-with-random-pointer/)

[148. æ’åºé“¾è¡¨](https://leetcode.cn/problems/sort-list/)

- å½’å¹¶çš„æ€æƒ³

```java
class Solution {
    private ListNode find(ListNode head) {
        ListNode fast = head, slow = head;
        while(fast.next != null && fast.next.next != null) {
            fast = fast.next.next;
            slow = slow.next;
        }
        return slow;
    }
    public ListNode sortList(ListNode head) {
        if(head == null || head.next == null) {
            return head;
        }
        // å¿«æ…¢æŒ‡é’ˆæ‰¾åˆ°ç¬¬ä¸€éƒ¨åˆ†çš„å°¾èŠ‚ç‚¹
        ListNode endOfFirst = find(head);
        // æ‰¾åˆ°ç¬¬äºŒéƒ¨åˆ†çš„å¤´èŠ‚ç‚¹
        ListNode startOfSecond = endOfFirst.next;
        // æ–­å¼€ä¸¤ä¸ªéƒ¨åˆ†
        endOfFirst.next = null;
        // å½’å¹¶æ’åº
        ListNode left = sortList(head);
        ListNode right = sortList(startOfSecond);
        ListNode h = new ListNode(0);
        ListNode res = h;
        while(left != null && right != null) {
            if(left.val < right.val) {
                h.next = left;
                left = left.next;
            }
            else {
                h.next = right;
                right = right.next;
            }
            h = h.next;
        }
        h.next = left != null ? left : right;
        return res.next;
    }
}
```

[23. åˆå¹¶ K ä¸ªå‡åºé“¾è¡¨](https://leetcode.cn/problems/merge-k-sorted-lists/)

- ä¼˜å…ˆé˜Ÿåˆ— N x logï¼ˆkï¼‰ï¼Œæ¯æ¬¡æ‰¾logkæ¬¡æ•°æ‰¾åˆ°æœ€å°èŠ‚ç‚¹ï¼Œéœ€è¦æ‰¾Næ¬¡ï¼ŒNæ˜¯å…ƒç´ ä¸ªæ•°

```java
class Solution {
    public ListNode mergeKLists(ListNode[] lists) {
        if (lists == null || lists.length == 0) return null;
        // ä¼˜å…ˆé˜Ÿåˆ—
        PriorityQueue<ListNode> queue = 
          new PriorityQueue<>(lists.length, (a, b) -> a.val - b.val);
        ListNode dummy = new ListNode(-1);
        ListNode p = dummy;
        for(ListNode node : lists) {
            if(node != null) queue.add(node);
        }
        while(!queue.isEmpty()) {
            p.next = queue.poll();
            p = p.next;
            if(p.next != null) {
                queue.add(p.next);
            }
        }
        return dummy.next;
    }
}
```

[146. LRU ç¼“å­˜](https://leetcode.cn/problems/lru-cache/)

## äºŒå‰æ ‘



[236. äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ](https://leetcode.cn/problems/lowest-common-ancestor-of-a-binary-tree/)

- å®šä¹‰LCA(R, P, Q)ï¼šå¦‚æœå·¦å­æ ‘å’Œå³å­æ ‘ ä¸­åŒæ—¶åŒ…å«på’Œqï¼ŒRå°±æ˜¯æœ€è¿‘å…¬å…±ç¥–å…ˆï¼Œ LCAè¡¨ç¤ºå¾€ä¸Šè¿”å› æ˜¯å¦æ‰¾åˆ°ï¼Œ å¦‚æœéƒ½æ²¡æœ‰ å°±å¾€ä¸Šè¿”å›null

```java
class Solution {
    public TreeNode lowestCommonAncestor(TreeNode root, TreeNode p, TreeNode q) {
        if(root == null) {
            return null;
        }
        if(root == p || root == q) {
            return root;
        }

        TreeNode left = lowestCommonAncestor(root.left, p, q);
        TreeNode right = lowestCommonAncestor(root.right, p, q);

        if(left != null && right != null) {
            return root;
        }

        return left != null ? left : right;
    }
}
```

## å›¾è®º

## å›æº¯

## äºŒåˆ†æŸ¥æ‰¾

## æ ˆ

### [20. æœ‰æ•ˆçš„æ‹¬å·](https://leetcode.cn/problems/valid-parentheses/) 

- ç»´æŠ¤ä¸€ä¸‹ å·¦å³åŒ¹é…çš„æ‹¬å·çš„ å…³ç³»
- é‡åˆ°ä¸åŒ¹é…çš„å°±breakï¼Œ åŒ¹é…å°±å¼¹å‡º
- æœ€åæ£€æŸ¥æ ˆæ˜¯å¦ä¸ºç©º

### [155. æœ€å°æ ˆ](https://leetcode.cn/problems/min-stack/)

- ms ç»´æŠ¤æœ€å°å€¼çš„æ ˆï¼Œ stk ç»´æŠ¤åŠ å…¥çš„æ‰€æœ‰å…ƒç´ 
- pushï¼šstkç›´æ¥pushï¼Œ msåˆ¤æ–­æ¯”peekå°æ‰push
- popï¼šstkç›´æ¥popï¼Œ msåˆ¤æ–­stk popå‡ºçš„æ•°æ˜¯å¦å’Œpeekç›¸åŒï¼Œç›¸åŒä¹Ÿpop
- getminï¼šms.peek
- topï¼šstk.peek

### ğŸŒŸ[394. å­—ç¬¦ä¸²è§£ç ](https://leetcode.cn/problems/decode-string/)

- numsæ•°å­—æ ˆ dict å­—ç¬¦æ ˆ
- é‡åˆ°æ•°å­— åŠ numsï¼Œ é‡åˆ°å­—ç¬¦å’Œ[ åŠ å…¥dictï¼Œ é‡åˆ°]å¼€å§‹æ¸…ç®—ï¼Œ å¼¹å‡ºå€æ•° å’Œ dicté‡Œé¢[ä¹‹å‰çš„ä¸€æ®µï¼Œæ‹¼æ¥å†pushè¿›å»

### ğŸŒŸ[739. æ¯æ—¥æ¸©åº¦](https://leetcode.cn/problems/daily-temperatures/)

- ç»å…¸å•è°ƒæ ˆï¼Œ æ¯ä¸ªå…ƒç´ åªä¼šå…¥æ ˆå‡ºæˆ˜ä¸€æ¬¡ ONåšæ³•
- ä»å‰å¾€åé¢é‡Œï¼Œæ ˆé‡Œé¢å­˜å‚¨çš„æ˜¯ è¿˜æ²¡æœ‰æ‰¾åˆ°ä¸‹ä¸€ä¸ªæ¯”ä»–å¤§çš„ä½ç½®çš„å…ƒç´ ï¼Œ ä¸€æ—¦æ‰¾åˆ°äº† å°±å¼¹å‡ºæ ˆ å¹¶æ›´æ–°
- ä»åå¾€å‰çš„æ€è·¯æ˜¯ï¼Œæ ˆé‡Œå­˜çš„æ˜¯ä¸‹ä¸€ä¸ªçš„æœ€å¤§ä½ç½®ï¼Œå¦‚æœå·²ç»æœ‰äº† 72 69 å†åˆ°71 çš„æ—¶å€™ï¼Œ69ä¸€å®šä¸å¯èƒ½æ˜¯å‰é¢çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼Œå¯ä»¥ä¸ç”¨è€ƒè™‘

### ğŸŒŸ[84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢](https://leetcode.cn/problems/largest-rectangle-in-histogram/)

```java
class Solution {
    public int largestRectangleArea(int[] hs) {
        // æšä¸¾é«˜åº¦ hs[i]
        // å¯¹äºæ¯ä¸€ä¸ª hs[i] èƒ½å¨¶åˆ°çš„æœ€å¤§å®½åº¦æ˜¯å¤šå°‘ï¼Ÿ
        // é¢„å¤„ç† l å’Œ ræ•°ç»„ï¼Œ l[i] è¡¨ç¤ºiå·¦è¾¹ï¼Œæœ€è¿‘ä¸€ä¸ªæ¯”ä»–å°çš„ä½ç½®
        // r[i] è¡¨ç¤ºiå³è¾¹ æœ€è¿‘ä¸€ä¸ªæ¯”ä»–å°çš„ä½ç½®ï¼Œ
        // return hs[i] * (r[i] - l[i] - 1)
        
        int n = hs.length;
        int[] l = new int[n];
        int[] r = new int[n];
        
        Arrays.fill(l, -1);
        Arrays.fill(r, n);
        Deque<Integer> stk = new ArrayDeque<>(n);
      // å…³é”®æ­¥éª¤ï¼Œ 
        for(int i = 0; i < n; i ++) {
            while(!stk.isEmpty() && hs[stk.peek()] > hs[i]) r[stk.pop()] = i;
            stk.push(i);
        }
        stk.clear();
        for(int i = n - 1; i >= 0; i --) {
            while(!stk.isEmpty() && hs[stk.peek()] > hs[i]) l[stk.pop()] = i;
            stk.push(i);
        }
        int ans = 0;
        for(int i = 0; i < n; i ++) {
            ans = Math.max(ans, (r[i] - l[i] - 1) * hs[i]);
        }
        return ans;
    }
}
```



## å †

### [215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ ](https://leetcode.cn/problems/kth-largest-element-in-an-array/)

- æ’åº nlogn
- å°æ ¹å †ï¼Œ kä¸ªï¼Œ ä¸æ–­åˆ é™¤æœ€å°çš„ï¼Œå‰©ä¸‹çš„éƒ½æ˜¯æœ€å¤§çš„ï¼Œ peekå°±æ˜¯ç¬¬kå¤§çš„ javaé‡Œé»˜è®¤å°±æ˜¯å°æ ¹ nlogk
- https://leetcode.cn/problems/kth-largest-element-in-an-array/solutions/2647778/javapython3cdui-pai-xu-kuai-su-pai-xu-ji-jcb9/?envType=study-plan-v2&envId=top-100-liked

### [347. å‰ K ä¸ªé«˜é¢‘å…ƒç´ ](https://leetcode.cn/problems/top-k-frequent-elements/)

- æ’åº nlogn, 
- å°æ ¹å †ï¼Œ nlogk

```java
class Solution {
    public int[] topKFrequent(int[] nums, int k) {
        Map<Integer, Integer> freq = new HashMap<>();
        for(int x : nums) freq.merge(x, 1, Integer::sum);
        PriorityQueue<Integer> pq = 
            new PriorityQueue<>((a, b) -> freq.get(a) - freq.get(b));
        for(int key : freq.keySet()) {
            pq.offer(key);
            if(pq.size() > k) {
                pq.poll();
            }
        }
        int[] res = new int[k];
        for(int i = 0; i < k; i ++) res[i] = pq.poll();
        return res;
    }
}
```

### ğŸŒŸ[295. æ•°æ®æµçš„ä¸­ä½æ•°](https://leetcode.cn/problems/find-median-from-data-stream/)

å¯¹é¡¶å †çš„åšæ³•ï¼Œ å°æ ¹å †ç»´æŠ¤å‰ä¸€éƒ¨åˆ†ï¼Œ å¤§æ ¹å †ç»´æŠ¤åä¸€éƒ¨åˆ†

ç»´æŠ¤å‰ä¸€éƒ¨åˆ†çš„æœ€å°å€¼ å’Œ åä¸€éƒ¨åˆ†çš„æœ€å¤§å€¼ï¼Œå‡è®¾ Må’ŒNåˆ†åˆ«ä¸ºsize

å¦‚æœ M == Nï¼Œè¿”å› A.peek + B.peek >> 1ï¼Œ å¦‚æœM ï¼=Nä»£ç ä¿è¯ M=N+1ï¼Œ è¿”å›A.peekå³å¯

logNæ—¶é—´å¤æ‚åº¦ï¼Œ

## è´ªå¿ƒ

[121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock/)

```java
class Solution {
    public int maxProfit(int[] prices) {
        int mi = prices[0];
        int ans = 0;
        // å¦‚æœç¬¬iå¤©å–å‡ºï¼Œ åˆ©æ¶¦å°±æ˜¯ å½“å¤©è‚¡ä»· - ä¹‹å‰æœ€å°çš„è‚¡ä»·
        // miç»´æŠ¤ä¹‹å‰æœ€å°çš„ï¼Œ ansç»´æŠ¤åˆ©æ¶¦æœ€å¤§çš„
        for(int i = 1; i < prices.length; i ++) {
            ans = Math.max(ans, prices[i] - mi);
            mi = Math.min(mi, prices[i]);
        }
        return ans;
    }
}
```

[55. è·³è·ƒæ¸¸æˆ](https://leetcode.cn/problems/jump-game/)

```java
class Solution {
    public boolean canJump(int[] nums) {
        // å‰é¢èƒ½èµ°åˆ°çš„æœ€è¿œè·ç¦»
        int pre = 0;
        int n = nums.length;
        for(int i = 0; i < n; i ++) {
            if(i > pre) {
                return false; // å¦‚æœä¹‹å‰æœ€è¿œçš„ä¸€æ­¥éƒ½èµ°ä¸åˆ°è¿™ï¼Œå°±è¯´æ˜åˆ°ä¸äº†
            }
            int far = nums[i] + i; // æ›´æ–°ä¸€ä¸‹æœ€è¿œçš„è·ç¦»
            pre = Math.max(far, pre);
        }
        return true;
    }
}

class Solution {
    public boolean canJump(int[] nums) {
        if(nums.length == 1) {
            return true;
        }
        // å®šä¹‰è¦†ç›–èŒƒå›´
        int cover = 0;
        for(int i = 0; i <= cover; i ++) {
            cover = Math.max(cover, nums[i] + i);
            if(cover >= nums.length - 1) {
                return true;
            }
        }
        return false;
    }
}
```

## åŠ¨æ€è§„åˆ’

## å¤šç»´åŠ¨å½’

[62. ä¸åŒè·¯å¾„](https://leetcode.cn/problems/unique-paths/)

```
f[i][j]è¡¨ç¤º  èµ°åˆ° i, j ä½ç½®ä¸Šçš„ æ€»å…±æœ‰å¤šå°‘æ¡ä¸åŒçš„è·¯å¾„ï¼Œ ç­”æ¡ˆè¿”å› f[m - 1][n - 1]

æ€ä¹ˆè½¬ç§»ï¼Œ ç¬¬ä¸€è¡Œ ç¬¬ä¸€åˆ—çš„æƒ…å†µï¼Œ åªèƒ½ä»å•ä¾§æ¥ï¼Œ f = 1, å…¶ä»–æƒ…å†µï¼Œæœ‰ ä»ä¸Šå’Œå·¦ä¸¤ä¸ªä½ç½®æ¥ 
f[i][j] = f[i - 1][j] + f[i][j - 1]

åˆå§‹åŒ– ç¬¬ä¸€è¡Œ ç¬¬ä¸€åˆ— éƒ½æ˜¯1 

éå†é¡ºåº i å’Œ jéƒ½ä¾èµ– ä¸Šä¸€æ­¥ï¼Œ ä»å·¦åˆ°å³ï¼Œä»ä¸Šåˆ°ä¸‹
```

[64. æœ€å°è·¯å¾„å’Œ](https://leetcode.cn/problems/minimum-path-sum/)

ç»™å®šä¸€ä¸ªåŒ…å«éè´Ÿæ•´æ•°çš„ *m* x *n*` ç½‘æ ¼ `grid ï¼Œè¯·æ‰¾å‡ºä¸€æ¡ä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’çš„è·¯å¾„ï¼Œä½¿å¾—è·¯å¾„ä¸Šçš„æ•°å­—æ€»å’Œä¸ºæœ€å°ã€‚**è¯´æ˜ï¼š**æ¯æ¬¡åªèƒ½å‘ä¸‹æˆ–è€…å‘å³ç§»åŠ¨ä¸€æ­¥ã€‚

```
f[i][j] è¡¨ç¤º èµ°åˆ°iï¼Œjä½ç½®ä¸Šçš„ æœ€å°è·¯å¾„æ€»å’Œ, è¿”å› f[m - 1][n - 1]

æ€ä¹ˆè½¬ç§» 
- å¯¹äºç¬¬ä¸€è¡Œ f[i][j] = f[i][j - 1] + grid[i][j]
- å¯¹äºç¬¬ä¸€åˆ— f[i][j] = f[i - 1][j] + grid[i][j]
- å…¶ä»–çš„ä½ç½® f[i][j] = min(f[i - 1][j], f[i][j - 1]) + grid[i][j]

åˆå§‹åŒ– f[0][0] = grid[0][0] 

ä»ä¸Šåˆ°ä¸‹ï¼Œ ä»å·¦åˆ°å³
```

- å¯ä»¥çœå»ç©ºé—´ï¼Œ åœ¨gridåŸºç¡€ä¸Šæ›´æ–°

[5. æœ€é•¿å›æ–‡å­ä¸²](https://leetcode.cn/problems/longest-palindromic-substring/)

- åŠ¨æ€è§„åˆ’

```
f[i][j] è¡¨ç¤º s.substring(i, j + 1) æ˜¯å¦ä¸ºå›æ–‡ä¸²

æ€ä¹ˆè½¬ç§», æ€è€ƒï¼Œé•¿åº¦å°çš„ è½¬ç§»åˆ°é•¿åº¦å¤§çš„ len = j - i + 1;
for(int len = 1; len <= n; len ++) {
	for(int i = 0; i + len - 1 < n; i ++) {
		int j = i + len - 1;
		//
	}
	å®é™…ä¸Šï¼Œ iä»å°åˆ°å¤§ï¼Œ jä»å¤§åˆ°å°
}
if(len == 1)  f[i][j] ä¸€å®šä¸ºtrue
if(len == 2 || len == 3) f[i][j] çš„å€¼å–å†³äº s[i] == s[j]
if(len > 3) f[i][j] = f[i+1][j-1] && (s[i] == s[j])
```

- ä¸­å¿ƒæ‰©æ•£æ³•
  - éå†æ¯ä¸€ä¸ªç‚¹ï¼Œä»è¯¥ç‚¹å¼€å§‹åƒä¸¤è¾¹æ‰©æ•£ 
  - åˆ†å¥‡å¶çš„æƒ…å†µ centerSpread èµ°ä¸¤éï¼Œ (i, i) (i, i+1)

## æŠ€å·§

[169. å¤šæ•°å…ƒç´ ](https://leetcode.cn/problems/majority-element/)

- å“ˆå¸Œè¡¨è®¡æ•°
- æ•°ç»„æ’åºï¼Œå¤šæ•°å…ƒç´ ä¸€å®šæ˜¯ä¸­ç‚¹
- æ‘©å°”æŠ•ç¥¨

```java
class Solution {
    public int majorityElement(int[] nums) {
        int votes = 0;
        int ans = 0;
      // votesä¸º0æ—¶ å‡è®¾å½“å‰çš„æ•°ä¸ºä¼—æ•°ï¼Œ å¼€å§‹è®¡æ•°ï¼Œ æ˜¯+1ï¼Œä¸æ˜¯-1
        for(int num : nums) {
            if(votes == 0) ans = num;
            votes += num == ans ? 1 : -1; 
        }
        return ans;
    }
}
