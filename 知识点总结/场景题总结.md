## 题目描述

给定a，b两个文件，各存放50亿各URL，每个URL各占64B，内存限制是4G。请找出a，b两个文件共同的URL。

## 解答思路

每个URL占64B，50亿个URL占用的空间大小约为320GB。

$$5,000,000,000 * 64B \approx 5GB * 64 = 320GB $$

内存大小只有4GB，因此，我们不可能一次性把所有URL加载到内存中处理，我们可以采用分治的思路：

> 把一个文件中的URL按照某个特征划分为多个小文件，使得每个小文件大小不超过4G，这样就可以分别将这些小文件读到内存中进行处理。



- 首先遍历文件a，对遍历的URL求$$hash(URL) \% 1000$$，根据计算结果把遍历到的URL存储到$$a_0，a_1，a_2……a_{999}$$，这样每个大小约为300MB。
- 使用同样的方法遍历文件b，同样把文件b中的URL分别存储文件$$b_0，b_1，b_2，……b_{999}$$中。
- 处理过后，所有可能相同的URL都在对应的小文件中，即$$a_0$$对应$$b_0$$，$$a_n$$对应$b_n$，$n \in [0, 999]$。不对应的小文件不可能有相同的URL，接下来我们只需要求出这1000对文件中相同的URL即可。
- 遍历$a_i(i \in [0, 999])$，将URL存储到一个HashSet中，然后遍历$b_i(i \in [0, 999])$，中的每个URL，看在HashSet集合中是否存在，若存在，说明是共同的URL，可以把这个URL保存到一个单独的文件中。



## 参考

- 微信公众号：武哥聊编程