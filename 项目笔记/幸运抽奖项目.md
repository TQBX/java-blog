该系统采用DDD架构设计，划分为抽奖活动、抽奖策略、奖品、积分、返利等领域。代码开发运用多种设计模式，支持多种营销策略，如：用户积分兑换抽奖次数、积分返利等，实现差异化抽奖流程，如：通用抽奖、黑名单、抽奖N次解锁奖品范围、消耗积分解锁奖品等各类玩法，并对抽奖的计算和秒杀做了设计优化。

- 根据不同的抽奖玩法，将抽奖流程抽象为抽奖前后两阶段抽奖。运用模版模式、工厂模式定义通用抽奖流程，抽奖前采用责任链完成黑名单、奖品权重过滤，采用自定义规则树对抽奖后的动作的次数和库存信息进行动态处理，实现差异化抽奖。
- 考虑到抽奖的峰值流量高，面对高并发抽奖请求和库存扣减，采用Redis decr分段消费和加锁兜底的设计，对于消费成功的库存，采用异步队列+定时任务更新库存，在不超卖的同时，减轻数据库压力并确保数据的最终一致性。
- 使用RabbitMQ消息实现发奖异步化，缩短用户的等待时间，利用定时任务周期性扫描库表，补偿未正确发送或消费失败的MQ消息，确保抽奖流程的完整性和准确性。